{"addedFiles":{},"deletedFiles":{},"modifiedFiles":{"before":{"private/upload-to-cdn/index.js":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"script","interpreter":{"type":"InterpreterDirective","start":0,"end":19,"loc":{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":19,"index":19}},"value":"/usr/bin/env node","trailingComments":[{"type":"CommentLine","value":" Upload Uppy releases to Edgly.net CDN. Copyright (c) 2018, Transloadit Ltd.","start":20,"end":98,"loc":{"start":{"line":2,"column":0,"index":20},"end":{"line":2,"column":78,"index":98}}},{"type":"CommentLine","value":"","start":99,"end":101,"loc":{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":2,"index":101}}},{"type":"CommentLine","value":" This file:","start":102,"end":115,"loc":{"start":{"line":4,"column":0,"index":102},"end":{"line":4,"column":13,"index":115}}},{"type":"CommentLine","value":"","start":116,"end":118,"loc":{"start":{"line":5,"column":0,"index":116},"end":{"line":5,"column":2,"index":118}}},{"type":"CommentLine","value":"  - Assumes EDGLY_KEY and EDGLY_SECRET are available (e.g. set via Travis secrets)","start":119,"end":203,"loc":{"start":{"line":6,"column":0,"index":119},"end":{"line":6,"column":84,"index":203}}},{"type":"CommentLine","value":"  - Assumes a fully built uppy is in root dir (unless a specific tag was specified, then it's fetched from npm)","start":204,"end":317,"loc":{"start":{"line":7,"column":0,"index":204},"end":{"line":7,"column":113,"index":317}}},{"type":"CommentLine","value":"  - Collects dist/ files that would be in an npm package release, and uploads to","start":318,"end":400,"loc":{"start":{"line":8,"column":0,"index":318},"end":{"line":8,"column":82,"index":400}}},{"type":"CommentLine","value":"    eg. https://releases.transloadit.com/uppy/v1.0.1/uppy.css","start":401,"end":464,"loc":{"start":{"line":9,"column":0,"index":401},"end":{"line":9,"column":63,"index":464}}},{"type":"CommentLine","value":"  - Uses local package by default, if [version] argument was specified, takes package from npm","start":465,"end":561,"loc":{"start":{"line":10,"column":0,"index":465},"end":{"line":10,"column":96,"index":561}}},{"type":"CommentLine","value":"","start":562,"end":564,"loc":{"start":{"line":11,"column":0,"index":562},"end":{"line":11,"column":2,"index":564}}},{"type":"CommentLine","value":" Run as:","start":565,"end":575,"loc":{"start":{"line":12,"column":0,"index":565},"end":{"line":12,"column":10,"index":575}}},{"type":"CommentLine","value":"","start":576,"end":578,"loc":{"start":{"line":13,"column":0,"index":576},"end":{"line":13,"column":2,"index":578}}},{"type":"CommentLine","value":"  yarn uploadcdn <package-name> [version]","start":579,"end":622,"loc":{"start":{"line":14,"column":0,"index":579},"end":{"line":14,"column":43,"index":622}}},{"type":"CommentLine","value":"","start":623,"end":625,"loc":{"start":{"line":15,"column":0,"index":623},"end":{"line":15,"column":2,"index":625}}},{"type":"CommentLine","value":" To override an existing release (DANGER!)","start":626,"end":670,"loc":{"start":{"line":16,"column":0,"index":626},"end":{"line":16,"column":44,"index":670}}},{"type":"CommentLine","value":"","start":671,"end":673,"loc":{"start":{"line":17,"column":0,"index":671},"end":{"line":17,"column":2,"index":673}}},{"type":"CommentLine","value":"  yarn uploadcdn <package-name> [version] -- --force","start":674,"end":728,"loc":{"start":{"line":18,"column":0,"index":674},"end":{"line":18,"column":54,"index":728}}},{"type":"CommentLine","value":"","start":729,"end":731,"loc":{"start":{"line":19,"column":0,"index":729},"end":{"line":19,"column":2,"index":731}}},{"type":"CommentLine","value":" Authors:","start":732,"end":743,"loc":{"start":{"line":20,"column":0,"index":732},"end":{"line":20,"column":11,"index":743}}},{"type":"CommentLine","value":"","start":744,"end":746,"loc":{"start":{"line":21,"column":0,"index":744},"end":{"line":21,"column":2,"index":746}}},{"type":"CommentLine","value":"  - Kevin van Zonneveld <kevin@transloadit.com>","start":747,"end":796,"loc":{"start":{"line":22,"column":0,"index":747},"end":{"line":22,"column":49,"index":796}}}]},"body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"path"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"node:path"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"pipeline"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"pipeline"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"finished"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"finished"}}]},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"node:stream/promises"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"readFile"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"readFile"}}]},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"node:fs/promises"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"S3Client"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"S3Client"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"ListObjectsV2Command"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"ListObjectsV2Command"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"PutObjectCommand"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"PutObjectCommand"}}]},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"@aws-sdk/client-s3"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"packlist"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"npm-packlist"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"tar"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"tar"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"pacote"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"pacote"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"concat"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"concat-stream"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"mime"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"mime-types"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"AdmZip"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"adm-zip"}]}}],"kind":"const"},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"delay"},"generator":false,"async":false,"params":[{"type":"Identifier","name":"ms"}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"}],"body":{"type":"CallExpression","callee":{"type":"Identifier","name":"setTimeout"},"arguments":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"ms"}]}}]}}],"directives":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"AWS_REGION"},"init":{"type":"StringLiteral","value":"us-east-1"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"AWS_BUCKET"},"init":{"type":"StringLiteral","value":"releases.transloadit.com"}}],"kind":"const"},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRemoteDistFiles"},"generator":false,"async":true,"params":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"files"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Map"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"tarball"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"pacote"},"computed":false,"property":{"type":"Identifier","name":"tarball"}},"computed":false,"property":{"type":"Identifier","name":"stream"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":"@","cooked":"@"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"stream"}],"body":{"type":"CallExpression","callee":{"type":"Identifier","name":"pipeline"},"arguments":[{"type":"Identifier","name":"stream"},{"type":"NewExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tar"},"computed":false,"property":{"type":"Identifier","name":"Parse"}},"arguments":[]}]}}]}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tarball"},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"entry"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"readEntry"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"readEntry"},"computed":false,"property":{"type":"Identifier","name":"path"}},"computed":false,"property":{"type":"Identifier","name":"startsWith"}},"arguments":[{"type":"StringLiteral","value":"package/dist/"}]},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"readEntry"},"computed":false,"property":{"type":"Identifier","name":"pipe"}},"arguments":[{"type":"CallExpression","callee":{"type":"Identifier","name":"concat"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"buf"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"set"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"readEntry"},"computed":false,"property":{"type":"Identifier","name":"path"}},"computed":false,"property":{"type":"Identifier","name":"replace"}},"arguments":[{"type":"RegExpLiteral","pattern":"^package\\/dist\\/","flags":""},{"type":"StringLiteral","value":""}]},{"type":"Identifier","name":"buf"}]}}],"directives":[]}}]}]},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"error"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tarball"},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"error"},{"type":"Identifier","name":"err"}]}}],"directives":[]}}]}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"readEntry"},"computed":false,"property":{"type":"Identifier","name":"resume"}},"arguments":[]}}],"directives":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"finished"},"arguments":[{"type":"Identifier","name":"tarball"}]}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"files"}}],"directives":[]}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLocalDistFiles"},"generator":false,"async":true,"params":[{"type":"Identifier","name":"packagePath"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"files"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"packlist"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"path"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"packagePath"}}]}]}},"computed":false,"property":{"type":"Identifier","name":"filter"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"f"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"f"},"computed":false,"property":{"type":"Identifier","name":"startsWith"}},"arguments":[{"type":"StringLiteral","value":"dist/"}]}}]},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"f"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"f"},"computed":false,"property":{"type":"Identifier","name":"replace"}},"arguments":[{"type":"RegExpLiteral","pattern":"^dist\\/","flags":""},{"type":"StringLiteral","value":""}]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"entries"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"all"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"f"}],"body":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"f"},{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"readFile"},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"path"},"computed":false,"property":{"type":"Identifier","name":"join"}},"arguments":[{"type":"Identifier","name":"packagePath"},{"type":"StringLiteral","value":"dist"},{"type":"Identifier","name":"f"}]}]}}]}}]}]}}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Map"},"arguments":[{"type":"Identifier","name":"entries"}]}}],"directives":[]}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"main"},"generator":false,"async":true,"params":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"packageName"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"StringLiteral","value":"usage: upload-to-cdn <packagename> [version]"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"StringLiteral","value":"Must provide a package name"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"exit"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"EDGLY_KEY"}}},"operator":"||","right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"EDGLY_SECRET"}}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"StringLiteral","value":"Missing EDGLY_KEY or EDGLY_SECRET env variables, bailing"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"exit"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"version"},"computed":false,"property":{"type":"Identifier","name":"startsWith"},"optional":true},"optional":false,"arguments":[{"type":"StringLiteral","value":"-"}]},"consequent":{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"version"},"right":{"type":"Identifier","name":"undefined"}}},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"s3Client"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"S3Client"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"credentials"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"accessKeyId"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"EDGLY_KEY"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"secretAccessKey"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"EDGLY_SECRET"}}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"region"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"AWS_REGION"}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"remote"},"init":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"version"}}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"remote"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"version"},"right":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"packageName"}],"quasis":[{"type":"TemplateElement","value":{"raw":"../../packages/","cooked":"../../packages/"},"tail":false},{"type":"TemplateElement","value":{"raw":"/package.json","cooked":"/package.json"},"tail":true}]}]},"computed":false,"property":{"type":"Identifier","name":"version"}}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"remote"}},"operator":"&&","right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"CI"}}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"Warning, writing a local build to the CDN, this is usually not what you want. Sleeping 3s. Press CTRL+C!"}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"delay"},"arguments":[{"type":"NumericLiteral","value":3000}]}}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"packagePath"},"init":{"type":"ConditionalExpression","test":{"type":"Identifier","name":"remote"},"consequent":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":"@","cooked":"@"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},"alternate":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"path"},"computed":false,"property":{"type":"Identifier","name":"join"}},"arguments":[{"type":"Identifier","name":"__dirname"},{"type":"StringLiteral","value":".."},{"type":"StringLiteral","value":"packages"},{"type":"Identifier","name":"packageName"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"dirName"},"init":{"type":"ConditionalExpression","test":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"packageName"},"computed":false,"property":{"type":"Identifier","name":"startsWith"}},"arguments":[{"type":"StringLiteral","value":"@uppy/"}]},"consequent":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"packageName"},"computed":false,"property":{"type":"Identifier","name":"replace"}},"arguments":[{"type":"RegExpLiteral","pattern":"^@","flags":""},{"type":"StringLiteral","value":""}]},"alternate":{"type":"StringLiteral","value":"uppy"}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"outputPath"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"path"},"computed":false,"property":{"type":"Identifier","name":"posix"}},"computed":false,"property":{"type":"Identifier","name":"join"}},"arguments":[{"type":"Identifier","name":"dirName"},{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"v","cooked":"v"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"Contents"},"computed":false,"method":false,"shorthand":false,"value":{"type":"Identifier","name":"existing"}}]},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s3Client"},"computed":false,"property":{"type":"Identifier","name":"send"}},"arguments":[{"type":"NewExpression","callee":{"type":"Identifier","name":"ListObjectsV2Command"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Bucket"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"AWS_BUCKET"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Prefix"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"outputPath"}}]}]}]}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"existing"},"computed":false,"property":{"type":"Identifier","name":"length"},"optional":true},"operator":">","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"argv"}},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"--force"}]},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"warn"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"dirName"},{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"WARN Release files for ","cooked":"WARN Release files for "},"tail":false},{"type":"TemplateElement","value":{"raw":" v","cooked":" v"},"tail":false},{"type":"TemplateElement","value":{"raw":" already exist, overwriting...","cooked":" already exist, overwriting..."},"tail":true}]}]}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"dirName"},{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"Release files for ","cooked":"Release files for "},"tail":false},{"type":"TemplateElement","value":{"raw":" v","cooked":" v"},"tail":false},{"type":"TemplateElement","value":{"raw":" already exist, exiting...","cooked":" already exist, exiting..."},"tail":true}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"exit"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"files"},"init":{"type":"ConditionalExpression","test":{"type":"Identifier","name":"remote"},"consequent":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"getRemoteDistFiles"},"arguments":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}]}},"alternate":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"getLocalDistFiles"},"arguments":[{"type":"Identifier","name":"packagePath"}]}}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"packageName"},"operator":"===","right":{"type":"StringLiteral","value":"uppy"}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"zip"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"AdmZip"},"arguments":[]}}],"kind":"const"},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ArrayPattern","elements":[{"type":"Identifier","name":"filename"},{"type":"Identifier","name":"buffer"}]},"init":null}],"kind":"const"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"entries"}},"arguments":[]},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"zip"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"Identifier","name":"filename"},{"type":"Identifier","name":"buffer"}]}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"set"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"uppy-v","cooked":"uppy-v"},"tail":false},{"type":"TemplateElement","value":{"raw":".zip","cooked":".zip"},"tail":true}]},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"zip"},"computed":false,"property":{"type":"Identifier","name":"toBuffer"}},"arguments":[]}]}}],"directives":[]},"alternate":null},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ArrayPattern","elements":[{"type":"Identifier","name":"filename"},{"type":"Identifier","name":"buffer"}]},"init":null}],"kind":"const"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"entries"}},"arguments":[]},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"key"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"path"},"computed":false,"property":{"type":"Identifier","name":"posix"}},"computed":false,"property":{"type":"Identifier","name":"join"}},"arguments":[{"type":"Identifier","name":"outputPath"},{"type":"Identifier","name":"filename"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"AWS_BUCKET"},{"type":"Identifier","name":"key"}],"quasis":[{"type":"TemplateElement","value":{"raw":"pushing s3://","cooked":"pushing s3://"},"tail":false},{"type":"TemplateElement","value":{"raw":"/","cooked":"/"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s3Client"},"computed":false,"property":{"type":"Identifier","name":"send"}},"arguments":[{"type":"NewExpression","callee":{"type":"Identifier","name":"PutObjectCommand"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Bucket"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"AWS_BUCKET"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Key"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ContentType"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mime"},"computed":false,"property":{"type":"Identifier","name":"lookup"}},"arguments":[{"type":"Identifier","name":"filename"}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Body"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"buffer"}}]}]}]}}}],"directives":[]}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"main"},"arguments":[{"type":"SpreadElement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"argv"}},"computed":false,"property":{"type":"Identifier","name":"slice"}},"arguments":[{"type":"NumericLiteral","value":2}]}}]},"computed":false,"property":{"type":"Identifier","name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"exit"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]}}]}}],"directives":[]}}},"after":{"private/upload-to-cdn/index.js":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"script","interpreter":{"type":"InterpreterDirective","start":0,"end":19,"loc":{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":19,"index":19}},"value":"/usr/bin/env node","trailingComments":[{"type":"CommentLine","value":" Upload Uppy releases to Edgly.net CDN. Copyright (c) 2018, Transloadit Ltd.","start":20,"end":98,"loc":{"start":{"line":2,"column":0,"index":20},"end":{"line":2,"column":78,"index":98}}},{"type":"CommentLine","value":"","start":99,"end":101,"loc":{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":2,"index":101}}},{"type":"CommentLine","value":" This file:","start":102,"end":115,"loc":{"start":{"line":4,"column":0,"index":102},"end":{"line":4,"column":13,"index":115}}},{"type":"CommentLine","value":"","start":116,"end":118,"loc":{"start":{"line":5,"column":0,"index":116},"end":{"line":5,"column":2,"index":118}}},{"type":"CommentLine","value":"  - Assumes EDGLY_KEY and EDGLY_SECRET are available (e.g. set via Travis secrets)","start":119,"end":203,"loc":{"start":{"line":6,"column":0,"index":119},"end":{"line":6,"column":84,"index":203}}},{"type":"CommentLine","value":"  - Assumes a fully built uppy is in root dir (unless a specific tag was specified, then it's fetched from npm)","start":204,"end":317,"loc":{"start":{"line":7,"column":0,"index":204},"end":{"line":7,"column":113,"index":317}}},{"type":"CommentLine","value":"  - Collects dist/ files that would be in an npm package release, and uploads to","start":318,"end":400,"loc":{"start":{"line":8,"column":0,"index":318},"end":{"line":8,"column":82,"index":400}}},{"type":"CommentLine","value":"    eg. https://releases.transloadit.com/uppy/v1.0.1/uppy.css","start":401,"end":464,"loc":{"start":{"line":9,"column":0,"index":401},"end":{"line":9,"column":63,"index":464}}},{"type":"CommentLine","value":"  - Uses local package by default, if [version] argument was specified, takes package from npm","start":465,"end":561,"loc":{"start":{"line":10,"column":0,"index":465},"end":{"line":10,"column":96,"index":561}}},{"type":"CommentLine","value":"","start":562,"end":564,"loc":{"start":{"line":11,"column":0,"index":562},"end":{"line":11,"column":2,"index":564}}},{"type":"CommentLine","value":" Run as:","start":565,"end":575,"loc":{"start":{"line":12,"column":0,"index":565},"end":{"line":12,"column":10,"index":575}}},{"type":"CommentLine","value":"","start":576,"end":578,"loc":{"start":{"line":13,"column":0,"index":576},"end":{"line":13,"column":2,"index":578}}},{"type":"CommentLine","value":"  yarn uploadcdn <package-name> [version]","start":579,"end":622,"loc":{"start":{"line":14,"column":0,"index":579},"end":{"line":14,"column":43,"index":622}}},{"type":"CommentLine","value":"","start":623,"end":625,"loc":{"start":{"line":15,"column":0,"index":623},"end":{"line":15,"column":2,"index":625}}},{"type":"CommentLine","value":" To override an existing release (DANGER!)","start":626,"end":670,"loc":{"start":{"line":16,"column":0,"index":626},"end":{"line":16,"column":44,"index":670}}},{"type":"CommentLine","value":"","start":671,"end":673,"loc":{"start":{"line":17,"column":0,"index":671},"end":{"line":17,"column":2,"index":673}}},{"type":"CommentLine","value":"  yarn uploadcdn <package-name> [version] -- --force","start":674,"end":728,"loc":{"start":{"line":18,"column":0,"index":674},"end":{"line":18,"column":54,"index":728}}},{"type":"CommentLine","value":"","start":729,"end":731,"loc":{"start":{"line":19,"column":0,"index":729},"end":{"line":19,"column":2,"index":731}}},{"type":"CommentLine","value":" Authors:","start":732,"end":743,"loc":{"start":{"line":20,"column":0,"index":732},"end":{"line":20,"column":11,"index":743}}},{"type":"CommentLine","value":"","start":744,"end":746,"loc":{"start":{"line":21,"column":0,"index":744},"end":{"line":21,"column":2,"index":746}}},{"type":"CommentLine","value":"  - Kevin van Zonneveld <kevin@transloadit.com>","start":747,"end":796,"loc":{"start":{"line":22,"column":0,"index":747},"end":{"line":22,"column":49,"index":796}}}]},"body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"path"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"node:path"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"pipeline"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"pipeline"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"finished"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"finished"}}]},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"node:stream/promises"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"readFile"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"readFile"}}]},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"node:fs/promises"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"S3Client"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"S3Client"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"ListObjectsV2Command"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"ListObjectsV2Command"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"PutObjectCommand"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"PutObjectCommand"}}]},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"@aws-sdk/client-s3"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"packlist"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"npm-packlist"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"tar"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"tar"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"pacote"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"pacote"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"concat"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"concat-stream"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"mime"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"mime-types"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"AdmZip"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"adm-zip"}]}}],"kind":"const"},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"delay"},"generator":false,"async":false,"params":[{"type":"Identifier","name":"ms"}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"}],"body":{"type":"CallExpression","callee":{"type":"Identifier","name":"setTimeout"},"arguments":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"ms"}]}}]}}],"directives":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"AWS_REGION"},"init":{"type":"StringLiteral","value":"us-east-1"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"AWS_BUCKET"},"init":{"type":"StringLiteral","value":"releases.transloadit.com"}}],"kind":"const"},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRemoteDistFiles"},"generator":false,"async":true,"params":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"files"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Map"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"tarball"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"pacote"},"computed":false,"property":{"type":"Identifier","name":"tarball"}},"computed":false,"property":{"type":"Identifier","name":"stream"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":"@","cooked":"@"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"stream"}],"body":{"type":"CallExpression","callee":{"type":"Identifier","name":"pipeline"},"arguments":[{"type":"Identifier","name":"stream"},{"type":"NewExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tar"},"computed":false,"property":{"type":"Identifier","name":"Parse"}},"arguments":[]}]}}]}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tarball"},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"entry"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"readEntry"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"readEntry"},"computed":false,"property":{"type":"Identifier","name":"path"}},"computed":false,"property":{"type":"Identifier","name":"startsWith"}},"arguments":[{"type":"StringLiteral","value":"package/dist/"}]},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"readEntry"},"computed":false,"property":{"type":"Identifier","name":"pipe"}},"arguments":[{"type":"CallExpression","callee":{"type":"Identifier","name":"concat"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"buf"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"set"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"readEntry"},"computed":false,"property":{"type":"Identifier","name":"path"}},"computed":false,"property":{"type":"Identifier","name":"replace"}},"arguments":[{"type":"RegExpLiteral","pattern":"^package\\/dist\\/","flags":""},{"type":"StringLiteral","value":""}]},{"type":"Identifier","name":"buf"}]}}],"directives":[]}}]}]},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"error"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tarball"},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"error"},{"type":"Identifier","name":"err"}]}}],"directives":[]}}]}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"readEntry"},"computed":false,"property":{"type":"Identifier","name":"resume"}},"arguments":[]}}],"directives":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"finished"},"arguments":[{"type":"Identifier","name":"tarball"}]}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"files"}}],"directives":[]}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLocalDistFiles"},"generator":false,"async":true,"params":[{"type":"Identifier","name":"packagePath"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"files"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"packlist"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"path"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"packagePath"}}]}]}},"computed":false,"property":{"type":"Identifier","name":"filter"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"f"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"f"},"computed":false,"property":{"type":"Identifier","name":"startsWith"}},"arguments":[{"type":"StringLiteral","value":"dist/"}]}}]},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"f"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"f"},"computed":false,"property":{"type":"Identifier","name":"replace"}},"arguments":[{"type":"RegExpLiteral","pattern":"^dist\\/","flags":""},{"type":"StringLiteral","value":""}]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"entries"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"all"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"f"}],"body":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"f"},{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"readFile"},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"path"},"computed":false,"property":{"type":"Identifier","name":"join"}},"arguments":[{"type":"Identifier","name":"packagePath"},{"type":"StringLiteral","value":"dist"},{"type":"Identifier","name":"f"}]}]}}]}}]}]}}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Map"},"arguments":[{"type":"Identifier","name":"entries"}]}}],"directives":[]}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"main"},"generator":false,"async":true,"params":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"packageName"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"StringLiteral","value":"usage: upload-to-cdn <packagename> [version]"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"StringLiteral","value":"Must provide a package name"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"exit"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"EDGLY_KEY"}}},"operator":"||","right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"EDGLY_SECRET"}}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"StringLiteral","value":"Missing EDGLY_KEY or EDGLY_SECRET env variables, bailing"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"exit"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"version"},"computed":false,"property":{"type":"Identifier","name":"startsWith"},"optional":true},"optional":false,"arguments":[{"type":"StringLiteral","value":"-"}]},"consequent":{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"version"},"right":{"type":"Identifier","name":"undefined"}}},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"s3Client"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"S3Client"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"credentials"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"accessKeyId"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"EDGLY_KEY"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"secretAccessKey"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"EDGLY_SECRET"}}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"region"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"AWS_REGION"}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"remote"},"init":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"version"}}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"remote"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"version"},"right":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"require"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"packageName"}],"quasis":[{"type":"TemplateElement","value":{"raw":"../../packages/","cooked":"../../packages/"},"tail":false},{"type":"TemplateElement","value":{"raw":"/package.json","cooked":"/package.json"},"tail":true}]}]},"computed":false,"property":{"type":"Identifier","name":"version"}}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"remote"}},"operator":"&&","right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"env"}},"computed":false,"property":{"type":"Identifier","name":"CI"}}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"Warning, writing a local build to the CDN, this is usually not what you want. Sleeping 3s. Press CTRL+C!"}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"delay"},"arguments":[{"type":"NumericLiteral","value":3000}]}}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"packagePath"},"init":{"type":"ConditionalExpression","test":{"type":"Identifier","name":"remote"},"consequent":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":"@","cooked":"@"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},"alternate":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"path"},"computed":false,"property":{"type":"Identifier","name":"join"}},"arguments":[{"type":"Identifier","name":"__dirname"},{"type":"StringLiteral","value":".."},{"type":"StringLiteral","value":".."},{"type":"StringLiteral","value":"packages"},{"type":"Identifier","name":"packageName"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"dirName"},"init":{"type":"ConditionalExpression","test":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"packageName"},"computed":false,"property":{"type":"Identifier","name":"startsWith"}},"arguments":[{"type":"StringLiteral","value":"@uppy/"}]},"consequent":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"packageName"},"computed":false,"property":{"type":"Identifier","name":"replace"}},"arguments":[{"type":"RegExpLiteral","pattern":"^@","flags":""},{"type":"StringLiteral","value":""}]},"alternate":{"type":"StringLiteral","value":"uppy"}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"outputPath"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"path"},"computed":false,"property":{"type":"Identifier","name":"posix"}},"computed":false,"property":{"type":"Identifier","name":"join"}},"arguments":[{"type":"Identifier","name":"dirName"},{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"v","cooked":"v"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"Contents"},"computed":false,"method":false,"shorthand":false,"value":{"type":"Identifier","name":"existing"}}]},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s3Client"},"computed":false,"property":{"type":"Identifier","name":"send"}},"arguments":[{"type":"NewExpression","callee":{"type":"Identifier","name":"ListObjectsV2Command"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Bucket"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"AWS_BUCKET"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Prefix"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"outputPath"}}]}]}]}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"existing"},"computed":false,"property":{"type":"Identifier","name":"length"},"optional":true},"operator":">","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"argv"}},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"--force"}]},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"warn"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"dirName"},{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"WARN Release files for ","cooked":"WARN Release files for "},"tail":false},{"type":"TemplateElement","value":{"raw":" v","cooked":" v"},"tail":false},{"type":"TemplateElement","value":{"raw":" already exist, overwriting...","cooked":" already exist, overwriting..."},"tail":true}]}]}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"dirName"},{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"Release files for ","cooked":"Release files for "},"tail":false},{"type":"TemplateElement","value":{"raw":" v","cooked":" v"},"tail":false},{"type":"TemplateElement","value":{"raw":" already exist, exiting...","cooked":" already exist, exiting..."},"tail":true}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"exit"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"files"},"init":{"type":"ConditionalExpression","test":{"type":"Identifier","name":"remote"},"consequent":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"getRemoteDistFiles"},"arguments":[{"type":"Identifier","name":"packageName"},{"type":"Identifier","name":"version"}]}},"alternate":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"getLocalDistFiles"},"arguments":[{"type":"Identifier","name":"packagePath"}]}}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"packageName"},"operator":"===","right":{"type":"StringLiteral","value":"uppy"}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"zip"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"AdmZip"},"arguments":[]}}],"kind":"const"},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ArrayPattern","elements":[{"type":"Identifier","name":"filename"},{"type":"Identifier","name":"buffer"}]},"init":null}],"kind":"const"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"entries"}},"arguments":[]},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"zip"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"Identifier","name":"filename"},{"type":"Identifier","name":"buffer"}]}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"set"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"version"}],"quasis":[{"type":"TemplateElement","value":{"raw":"uppy-v","cooked":"uppy-v"},"tail":false},{"type":"TemplateElement","value":{"raw":".zip","cooked":".zip"},"tail":true}]},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"zip"},"computed":false,"property":{"type":"Identifier","name":"toBuffer"}},"arguments":[]}]}}],"directives":[]},"alternate":null},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ArrayPattern","elements":[{"type":"Identifier","name":"filename"},{"type":"Identifier","name":"buffer"}]},"init":null}],"kind":"const"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files"},"computed":false,"property":{"type":"Identifier","name":"entries"}},"arguments":[]},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"key"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"path"},"computed":false,"property":{"type":"Identifier","name":"posix"}},"computed":false,"property":{"type":"Identifier","name":"join"}},"arguments":[{"type":"Identifier","name":"outputPath"},{"type":"Identifier","name":"filename"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"AWS_BUCKET"},{"type":"Identifier","name":"key"}],"quasis":[{"type":"TemplateElement","value":{"raw":"pushing s3://","cooked":"pushing s3://"},"tail":false},{"type":"TemplateElement","value":{"raw":"/","cooked":"/"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s3Client"},"computed":false,"property":{"type":"Identifier","name":"send"}},"arguments":[{"type":"NewExpression","callee":{"type":"Identifier","name":"PutObjectCommand"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Bucket"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"AWS_BUCKET"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Key"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ContentType"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mime"},"computed":false,"property":{"type":"Identifier","name":"lookup"}},"arguments":[{"type":"Identifier","name":"filename"}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Body"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"buffer"}}]}]}]}}}],"directives":[]}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"main"},"arguments":[{"type":"SpreadElement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"argv"}},"computed":false,"property":{"type":"Identifier","name":"slice"}},"arguments":[{"type":"NumericLiteral","value":2}]}}]},"computed":false,"property":{"type":"Identifier","name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"error"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"process"},"computed":false,"property":{"type":"Identifier","name":"exit"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]}}]}}],"directives":[]}}}},"renamedFiles":{"mappings":[],"before":{},"after":{}}}