{"addedFiles":{},"deletedFiles":{},"modifiedFiles":{"before":{"packages/@uppy/aws-s3/src/index.test.ts":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"module","interpreter":null,"body":[{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"afterEach"},"importKind":"value","local":{"type":"Identifier","name":"afterEach"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"beforeEach"},"importKind":"value","local":{"type":"Identifier","name":"beforeEach"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"describe"},"importKind":"value","local":{"type":"Identifier","name":"describe"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"expect"},"importKind":"value","local":{"type":"Identifier","name":"expect"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"it"},"importKind":"value","local":{"type":"Identifier","name":"it"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"vi"},"importKind":"value","local":{"type":"Identifier","name":"vi"}}],"source":{"type":"StringLiteral","value":"vitest"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[],"source":{"type":"StringLiteral","value":"whatwg-fetch"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"nock"}}],"source":{"type":"StringLiteral","value":"nock"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"Core"}}],"source":{"type":"StringLiteral","value":"@uppy/core"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"AwsS3Multipart"}}],"source":{"type":"StringLiteral","value":"./index.ts"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"Body"}}],"source":{"type":"StringLiteral","value":"./utils.ts"}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"KB"},"init":{"type":"NumericLiteral","value":1024}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"MB"},"init":{"type":"BinaryExpression","left":{"type":"Identifier","name":"KB"},"operator":"*","right":{"type":"Identifier","name":"KB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"beforeEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"nock"},"computed":false,"property":{"type":"Identifier","name":"disableNetConnect"}},"arguments":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"Registers AwsS3Multipart upload plugin"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"pluginNames"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getPlugins"}]}},"arguments":[{"type":"StringLiteral","value":"uploader"}]},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"plugin","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}}],"body":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"plugin"},"computed":false,"property":{"type":"Identifier","name":"constructor"}},"computed":false,"property":{"type":"Identifier","name":"name"}}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"pluginNames"}]},"computed":false,"property":{"type":"Identifier","name":"toContain"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"companionUrl assertion"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"Throws an error for main functions if configured without companionUrl"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart"},"init":{"type":"TSNonNullExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"err"},"init":{"type":"StringLiteral","value":"Expected a `companionUrl` option"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"file"},"init":{"type":"ObjectExpression","properties":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"opts"},"init":{"type":"ObjectExpression","properties":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}},"arguments":[{"type":"Identifier","name":"file"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"listParts"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"opts"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"completeMultipartUpload"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"opts"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"abortMultipartUpload"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"opts"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"opts"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"non-multipart upload"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"should handle POST uploads"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":0}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"POST"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com/"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"fields"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}}]}}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scope"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"POST"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag, Location"}}]}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"options"}},"arguments":[{"type":"StringLiteral","value":"/"}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":204},{"type":"StringLiteral","value":""}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"post"}},"arguments":[{"type":"StringLiteral","value":"/"}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":201},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"http://example.com"}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"NumericLiteral","value":1}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadSuccessHandler"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"upload-success"},{"type":"Identifier","name":"uploadSuccessHandler"}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadSuccessHandler"},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}}]},"computed":false,"property":{"type":"Identifier","name":"toHaveLength"}},"arguments":[{"type":"NumericLiteral","value":1}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadSuccessHandler"},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":true,"property":{"type":"NumericLiteral","value":0}},"computed":true,"property":{"type":"NumericLiteral","value":1}}]},"computed":false,"property":{"type":"Identifier","name":"toStrictEqual"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"body"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"http://example.com"}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":200}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadURL"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"http://example.com"}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"done"}},"arguments":[]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"without companionUrl (custom main functions)"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"beforeEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":0}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"6aeb1980f3fc7ce0b5454d25b71992"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test/upload/multitest.dat"}}]}}],"directives":[]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"file"},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"number"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"number"}}]}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"number"}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"headers"},"computed":false,"shorthand":false,"value":{"type":"ConditionalExpression","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"number"},"operator":"===","right":{"type":"NumericLiteral","value":1}},"consequent":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"Content-MD5"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"foo"}}]},"alternate":{"type":"Identifier","name":"undefined"}}}]}}],"directives":[]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"undefined"},"typeAnnotation":{"type":"TSAnyKeyword"}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"awsS3Multipart"},"right":{"type":"TSAsExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]},"typeAnnotation":{"type":"TSAnyKeyword"}}}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"Keeps chunks marked as busy through retries until they complete"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scope"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag"}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":50},"operator":"*","right":{"type":"Identifier","name":"MB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"options"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]},"operator":"&&","right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"partNumber=7"}]}}}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"calls"},"init":{"type":"NumericLiteral","value":0}}],"kind":"let"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]},"operator":"&&","right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"partNumber=7"}]}}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"ConditionalExpression","test":{"type":"BinaryExpression","left":{"type":"UpdateExpression","operator":"++","prefix":false,"argument":{"type":"Identifier","name":"calls"}},"operator":"===","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":500}]},"alternate":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"persist"}},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"busySpy"},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"doneSpy"},"init":null}],"kind":"let"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":10}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"multipartUploader"},"init":{"type":"TSNonNullExpression","expression":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"testChunkState"},"init":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"multipartUploader"},"computed":false,"property":{"type":"Identifier","name":"chunkState"}},"computed":true,"property":{"type":"NumericLiteral","value":6}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"busy"},"init":{"type":"BooleanLiteral","value":false}}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"done"},"init":{"type":"BooleanLiteral","value":false}}],"kind":"let"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"busySpy"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"value"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"busy"},"right":{"type":"Identifier","name":"value"}}}],"directives":[]}}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"doneSpy"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"value"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"done"},"right":{"type":"Identifier","name":"value"}}}],"directives":[]}}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"defineProperty"}},"arguments":[{"type":"Identifier","name":"testChunkState"},{"type":"StringLiteral","value":"busy"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"get"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"Identifier","name":"busy"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"set"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"busySpy"}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"defineProperty"}},"arguments":[{"type":"Identifier","name":"testChunkState"},{"type":"StringLiteral","value":"done"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"get"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"Identifier","name":"done"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"set"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"doneSpy"}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"6aeb1980f3fc7ce0b5454d25b71992"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test/upload/multitest.dat"}}]}}],"directives":[]}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"doneSpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":1}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"doneSpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":true,"property":{"type":"NumericLiteral","value":0}},"computed":true,"property":{"type":"NumericLiteral","value":0}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"doneCallOrderNumber"},"init":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"doneSpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"invocationCallOrder"}},"computed":true,"property":{"type":"NumericLiteral","value":0}}}],"kind":"const"},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ArrayPattern","elements":[{"type":"Identifier","name":"index"},{"type":"Identifier","name":"callArgs"}]},"init":null}],"kind":"const"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"busySpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"entries"}},"arguments":[]},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"callArgs"},"computed":true,"property":{"type":"NumericLiteral","value":0}},"operator":"===","right":{"type":"BooleanLiteral","value":false}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"busySpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"invocationCallOrder"}},"computed":true,"property":{"type":"Identifier","name":"index"}}]},"computed":false,"property":{"type":"Identifier","name":"toBeGreaterThan"}},"arguments":[{"type":"Identifier","name":"doneCallOrderNumber"}]}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":10}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"MultipartUploader"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"createMultipartUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"6aeb1980f3fc7ce0b5454d25b71992"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test/upload/multitest.dat"}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"signPart"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"file"},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"partNumber"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"partNumber"}}]}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"partNumber"}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadPartBytes"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"afterEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"clearAllMocks"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"retries uploadPartBytes when it fails once"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"StringLiteral","value":"should ignore"}}],"directives":[]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signPart"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"property":{"type":"Identifier","name":"mockImplementationOnce"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"reject"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":500}}]}}]}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"undefined"},"typeAnnotation":{"type":"TSAnyKeyword"}}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart"},"init":{"type":"TSNonNullExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":5},"operator":"*","right":{"type":"Identifier","name":"MB"}},"operator":"+","right":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":1},"operator":"*","right":{"type":"Identifier","name":"MB"}}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"uploadPartBytes"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":3}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"calls `upload-error` when uploadPartBytes fails after all retries"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":10}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signPart"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"property":{"type":"Identifier","name":"mockImplementation"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"reject"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":500}}]}}]}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"undefined"},"typeAnnotation":{"type":"TSAnyKeyword"}}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart"},"init":{"type":"TSNonNullExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":5},"operator":"*","right":{"type":"Identifier","name":"MB"}},"operator":"+","right":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":1},"operator":"*","right":{"type":"Identifier","name":"MB"}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"mock"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"upload-error"},{"type":"Identifier","name":"mock"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}]},"computed":false,"property":{"type":"Identifier","name":"rejects"}},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":500}}]}}]}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"uploadPartBytes"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":3}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"mock"},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"dynamic companionHeader"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"oldToken"},"init":{"type":"StringLiteral","value":"old token"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"newToken"},"init":{"type":"StringLiteral","value":"new token"}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"beforeEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionUrl"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":""}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"authorization"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"oldToken"}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"awsS3Multipart"},"right":{"type":"TSAsExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]},"typeAnnotation":{"type":"TSAnyKeyword"}}}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"companionHeader is updated before uploading file"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"authorization"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"newToken"}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"client"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getClient"}]}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"client"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getCompanionHeaders"}]}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"authorization"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"Identifier","name":"newToken"}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"dynamic companionHeader using setOption"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"newToken"},"init":{"type":"StringLiteral","value":"new token"}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"companionHeader is updated before uploading file"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addPreProcessor"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"awsS3Multipart"},"right":{"type":"TSAsExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"authorization"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"newToken"}}]}}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"client"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getClient"}]}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"client"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getCompanionHeaders"}]}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"authorization"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"Identifier","name":"newToken"}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"file metadata across custom main functions"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"createMultipartUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"upload1234"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"name"}}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"signPart"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"partData"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"computed":true,"key":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"listParts"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"partKeys"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"keys"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}]},"computed":false,"property":{"type":"Identifier","name":"filter"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"metaKey"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"metaKey"},"computed":false,"property":{"type":"Identifier","name":"startsWith"}},"arguments":[{"type":"StringLiteral","value":"part"}]}}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"partKeys"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"metaKey"}],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"PartNumber"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":true,"property":{"type":"Identifier","name":"metaKey"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"metaKey"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Size"},"computed":false,"shorthand":false,"value":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":5},"operator":"*","right":{"type":"Identifier","name":"MB"}}}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"completeMultipartUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ForStatement","init":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"i"},"init":{"type":"NumericLiteral","value":1}}],"kind":"let"},"test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"i"},"operator":"<=","right":{"type":"NumericLiteral","value":10}},"update":{"type":"UpdateExpression","operator":"++","prefix":false,"argument":{"type":"Identifier","name":"i"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":true,"property":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"i"}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"Identifier","name":"i"}]}}],"directives":[]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"abortMultipartUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"abortingPart"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"NumericLiteral","value":5}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"beforeEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"signPart"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"listParts"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"preserves file metadata if upload is completed"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signPart"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"listParts"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"completeMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"abortMultipartUpload"}}]}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag"}}]}]},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]},"computed":false,"property":{"type":"Identifier","name":"persist"}},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":50},"operator":"*","right":{"type":"Identifier","name":"MB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"createMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"signPart"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalledTimes"}},"arguments":[{"type":"NumericLiteral","value":11}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"completeMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"preserves file metadata if upload is aborted"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"signPartWithAbort"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"partData"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}},"operator":"===","right":{"type":"NumericLiteral","value":5}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortingPart"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"removeFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"undefined"},"typeAnnotation":{"type":"TSAnyKeyword"}},"typeAnnotation":{"type":"TSStringKeyword"}}}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"computed":true,"key":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"signPartWithAbort"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"listParts"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"completeMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"abortMultipartUpload"}}]}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag"}}]}]},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]},"computed":false,"property":{"type":"Identifier","name":"persist"}},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":50},"operator":"*","right":{"type":"Identifier","name":"MB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"createMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"signPartWithAbort"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"abortMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"preserves file metadata if upload is paused and resumed"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"completeMultipartUploadAfterPause"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ForStatement","init":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"i"},"init":{"type":"NumericLiteral","value":1}}],"kind":"let"},"test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"i"},"operator":"<=","right":{"type":"NumericLiteral","value":10}},"update":{"type":"UpdateExpression","operator":"++","prefix":false,"argument":{"type":"Identifier","name":"i"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":true,"property":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"i"}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"Identifier","name":"i"}]}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"listParts"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"signPartWithPause"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"partData"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}},"operator":"===","right":{"type":"NumericLiteral","value":3}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortingPart"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"pauseResume"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"setTimeout"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"pauseResume"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"NumericLiteral","value":500}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"computed":true,"key":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"signPartWithPause"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"listParts"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"completeMultipartUploadAfterPause"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"abortMultipartUpload"}}]}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag"}}]}]},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]},"computed":false,"property":{"type":"Identifier","name":"persist"}},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":50},"operator":"*","right":{"type":"Identifier","name":"MB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"createMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"signPartWithPause"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"listParts"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"completeMultipartUploadAfterPause"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}}],"directives":[]}}]}}],"directives":[]}}]}}],"directives":[]}}]}}],"directives":[]}},"packages/@uppy/aws-s3/src/index.ts":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"module","interpreter":null,"body":[{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"BasePlugin"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"DefinePluginOpts"},"local":{"type":"Identifier","name":"DefinePluginOpts"},"importKind":"type"},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"PluginOpts"},"local":{"type":"Identifier","name":"PluginOpts"},"importKind":"type"}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/BasePlugin.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RequestClient"},"importKind":"value","local":{"type":"Identifier","name":"RequestClient"}}],"source":{"type":"StringLiteral","value":"@uppy/companion-client"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RequestOptions"},"importKind":"value","local":{"type":"Identifier","name":"RequestOptions"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/CompanionClientProvider"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"_Body"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Meta"},"importKind":"value","local":{"type":"Identifier","name":"Meta"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UppyFile"},"importKind":"value","local":{"type":"Identifier","name":"UppyFile"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/UppyFile"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Uppy"},"importKind":"value","local":{"type":"Identifier","name":"Uppy"}}],"source":{"type":"StringLiteral","value":"@uppy/core"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"EventManager"}}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/EventManager.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RateLimitedQueue"},"importKind":"value","local":{"type":"Identifier","name":"RateLimitedQueue"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/RateLimitedQueue"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"filterNonFailedFiles"},"importKind":"value","local":{"type":"Identifier","name":"filterNonFailedFiles"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"},"importKind":"value","local":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/fileFilters"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"createAbortError"},"importKind":"value","local":{"type":"Identifier","name":"createAbortError"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/AbortController"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"getAllowedMetaFields"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/getAllowedMetaFields"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"MultipartUploader"}}],"source":{"type":"StringLiteral","value":"./MultipartUploader.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"throwIfAborted"},"importKind":"value","local":{"type":"Identifier","name":"throwIfAborted"}}],"source":{"type":"StringLiteral","value":"./utils.ts"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UploadResult"},"importKind":"value","local":{"type":"Identifier","name":"UploadResult"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UploadResultWithSignal"},"importKind":"value","local":{"type":"Identifier","name":"UploadResultWithSignal"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"MultipartUploadResultWithSignal"},"importKind":"value","local":{"type":"Identifier","name":"MultipartUploadResultWithSignal"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UploadPartBytesResult"},"importKind":"value","local":{"type":"Identifier","name":"UploadPartBytesResult"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"Body"}}],"source":{"type":"StringLiteral","value":"./utils.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"createSignedURL"}}],"source":{"type":"StringLiteral","value":"./createSignedURL.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"HTTPCommunicationQueue"},"importKind":"value","local":{"type":"Identifier","name":"HTTPCommunicationQueue"}}],"source":{"type":"StringLiteral","value":"./HTTPCommunicationQueue.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"packageJson"}}],"source":{"type":"StringLiteral","value":"../package.json"}},{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"MultipartFile"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"extends":[{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}],"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"s3Multipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"PartUploadedCallback"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"_Body"}}}]},"typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"part","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"PartNumber"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"ETag"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}},{"type":"TSModuleDeclaration","id":{"type":"StringLiteral","value":"@uppy/core"},"body":{"type":"TSModuleBlock","body":[{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"UppyEventMap"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"_Body"}}}]},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"StringLiteral","value":"s3-multipart:part-uploaded"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"PartUploadedCallback"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}]}}}]},"declare":true},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"assertServerError"},"generator":false,"async":false,"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"T"}]},"params":[{"type":"Identifier","name":"res","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"T"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"T"}}},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"OptionalMemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"res"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"error"},"optional":true},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"res"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"message"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"assign"}},"arguments":[{"type":"Identifier","name":"error"},{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"res"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"error"}}]}},{"type":"ThrowStatement","argument":{"type":"Identifier","name":"error"}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"res"}}],"directives":[]}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"AwsS3STSResponse"},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"credentials"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"AccessKeyId"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"SecretAccessKey"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"SessionToken"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"Expiration"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"bucket"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"region"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getExpiry"},"generator":false,"async":false,"params":[{"type":"Identifier","name":"credentials","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3STSResponse"}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"credentials"}}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSNumberKeyword"},{"type":"TSUndefinedKeyword"}]}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"expirationDate"},"init":{"type":"MemberExpression","object":{"type":"Identifier","name":"credentials"},"computed":false,"property":{"type":"Identifier","name":"Expiration"}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"Identifier","name":"expirationDate"},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"timeUntilExpiry"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Math"},"computed":false,"property":{"type":"Identifier","name":"floor"}},"arguments":[{"type":"BinaryExpression","left":{"type":"BinaryExpression","left":{"type":"TSAsExpression","expression":{"type":"TSAsExpression","expression":{"type":"NewExpression","callee":{"type":"Identifier","name":"Date"},"arguments":[{"type":"Identifier","name":"expirationDate"}]},"typeAnnotation":{"type":"TSAnyKeyword"}},"typeAnnotation":{"type":"TSNumberKeyword"}},"operator":"-","right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Date"},"computed":false,"property":{"type":"Identifier","name":"now"}},"arguments":[]}},"operator":"/","right":{"type":"NumericLiteral","value":1000}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"timeUntilExpiry"},"operator":">","right":{"type":"NumericLiteral","value":9}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"timeUntilExpiry"}}],"directives":[]},"alternate":null}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"undefined"}}],"directives":[]}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getAllowedMetadata"},"generator":false,"async":false,"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSAnyKeyword"}]}}}]},"params":[{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"meta"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"meta"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"querify"},"computed":false,"method":false,"shorthand":true,"value":{"type":"AssignmentPattern","left":{"type":"Identifier","name":"querify"},"right":{"type":"BooleanLiteral","value":false}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"meta"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}},{"type":"TSNullKeyword"}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"querify"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}]}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"metaFields"},"init":{"type":"LogicalExpression","left":{"type":"Identifier","name":"allowedMetaFields"},"operator":"??","right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"keys"}},"arguments":[{"type":"Identifier","name":"meta"}]}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"meta"}},"consequent":{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[]}},"alternate":null},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"fromEntries"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"metaFields"},"computed":false,"property":{"type":"Identifier","name":"filter"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"key"}],"body":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"meta"},"computed":true,"property":{"type":"Identifier","name":"key"}},"operator":"!=","right":{"type":"NullLiteral"}}}]},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"key"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"realKey"},"init":{"type":"ConditionalExpression","test":{"type":"Identifier","name":"querify"},"consequent":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"key"}],"quasis":[{"type":"TemplateElement","value":{"raw":"metadata[","cooked":"metadata["},"tail":false},{"type":"TemplateElement","value":{"raw":"]","cooked":"]"},"tail":true}]},"alternate":{"type":"Identifier","name":"key"}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"value"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"String"},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"meta"},"computed":true,"property":{"type":"Identifier","name":"key"}}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"realKey"},{"type":"Identifier","name":"value"}]}}],"directives":[]}}]}]}}],"directives":[]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"T"}]},"typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"T"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"T"}}]}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"SignPartOptions"},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"uploadId"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"key"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"partNumber"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"body"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AwsS3UploadParameters"},"typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"method"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"POST"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"url"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"fields"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"expires"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"headers"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}}]},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"method"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"PUT"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"url"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"fields"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSNeverKeyword"}]}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"expires"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"headers"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}}]}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"AwsS3Part"},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"PartNumber"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"Size"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"ETag"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3WithCompanion"},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"companionUrl"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"companionCookiesRule"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":true}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3WithoutCompanion"},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"options","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3STSResponse"}}]}}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signature"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"body"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"FormData"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"size"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onProgress"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onComplete"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadPartBytesResult"}}]}}}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanionMandatory"},"typeAnnotation":{"type":"TSTypeLiteral","members":[]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestOptions"}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanion"},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanionMandatory"}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":false}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithoutCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":false}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatorySignPart"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signPart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"SignPartOptions"}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"getChunkSize"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}]}}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"listParts"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResultWithSignal"}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Part"}}}]}}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResultWithSignal"}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]}}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"uploadId"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"key"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"parts"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Part"}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"location"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}]}}}}}}]},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatorySignPart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithoutCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":true}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MultipartWithCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":true}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MaybeMultipartWithCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanionMandatory"}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MaybeMultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithoutCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"RequestClientOptions"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"ConstructorParameters"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"RequestClient"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}]}},"indexType":{"type":"TSLiteralType","literal":{"type":"NumericLiteral","value":1}}}]}}},{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"_AwsS3MultipartOptions"},"extends":[{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"PluginOpts"}},{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"RequestClientOptions"}}],"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}},{"type":"TSBooleanKeyword"}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"limit"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"retryDelays"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSArrayType","elementType":{"type":"TSNumberKeyword"}},{"type":"TSNullKeyword"}]}}}]}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"_AwsS3MultipartOptions"}},{"type":"TSParenthesizedType","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MaybeMultipartWithCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MaybeMultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}}]}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"defaultOptions"},"init":{"type":"TSSatisfiesExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":6}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"BooleanLiteral","value":false},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"TSAsExpression","expression":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}}}],"body":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"size"}},"operator":"!==","right":{"type":"NumericLiteral","value":0}}},"typeAnnotation":{"type":"TSAnyKeyword"}},"typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":true}}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":0},{"type":"NumericLiteral","value":1000},{"type":"NumericLiteral","value":3000},{"type":"NumericLiteral","value":5000}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}]}}}}],"kind":"const"},{"type":"ExportDefaultDeclaration","exportKind":"value","declaration":{"type":"ClassDeclaration","id":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"superClass":{"type":"Identifier","name":"BasePlugin"},"superTypeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"DefinePluginOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"defaultOptions"}}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Pick"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSUnionType","types":[{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"getChunkSize"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"createMultipartUpload"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"listParts"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"abortMultipartUpload"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"completeMultipartUpload"}}]}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Required"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Pick"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithoutCompanion"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"uploadPartBytes"}}]}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatorySignPart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]},"body":{"type":"ClassBody","body":[{"type":"ClassProperty","static":true,"key":{"type":"Identifier","name":"VERSION"},"computed":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"packageJson"},"computed":false,"property":{"type":"Identifier","name":"version"}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"companionCommunicationQueue"}},"value":null},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}},"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestClient"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}},"value":null},{"type":"ClassProperty","accessibility":"protected","static":false,"key":{"type":"Identifier","name":"requests"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}},"value":null},{"type":"ClassProperty","accessibility":"protected","static":false,"key":{"type":"Identifier","name":"uploaderEvents"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"EventManager"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSNullKeyword"}]}]}}},"value":null},{"type":"ClassProperty","accessibility":"protected","static":false,"key":{"type":"Identifier","name":"uploaders"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartUploader"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSNullKeyword"}]}]}}},"value":null},{"type":"ClassProperty","accessibility":"protected","static":false,"key":{"type":"Identifier","name":"uploaderSockets"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSNeverKeyword"}]}}},"value":null},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"constructor"},"computed":false,"kind":"constructor","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uppy","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Uppy"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Super"},"arguments":[{"type":"Identifier","name":"uppy"},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"defaultOptions"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"AwsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"uploadPartBytes"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"opts"}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"type"}},"right":{"type":"StringLiteral","value":"uploader"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"id"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"||","right":{"type":"StringLiteral","value":"AwsS3Multipart"}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"title"}},"right":{"type":"StringLiteral","value":"AWS S3 Multipart"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"RequestClient"},"arguments":[{"type":"Identifier","name":"uppy"},{"type":"TSAsExpression","expression":{"type":"Identifier","name":"opts"},"typeAnnotation":{"type":"TSAnyKeyword"}}]}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"dynamicDefaultOptions"},"init":{"type":"TSSatisfiesExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"listParts"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"abortMultipartUpload"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"completeMultipartUpload"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"ConditionalExpression","test":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"optional":true},"consequent":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"createSignedURL"}},"alternate":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"signPart"}}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"shorthand":false,"value":{"type":"ConditionalExpression","test":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"optional":true},"consequent":{"type":"TSAsExpression","expression":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"createSignedURL"}},"typeAnnotation":{"type":"TSAnyKeyword"}},"alternate":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"getUploadParameters"}}}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}}}}],"kind":"const"},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"key"},"init":null}],"kind":"const"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"keys"}},"arguments":[{"type":"Identifier","name":"dynamicDefaultOptions"}]},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":true,"property":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"key"},"typeAnnotation":{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"dynamicDefaultOptions"}}}}},"operator":"==","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":true,"property":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"key"},"typeAnnotation":{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"dynamicDefaultOptions"}}}}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"dynamicDefaultOptions"},"computed":true,"property":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"key"},"typeAnnotation":{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"dynamicDefaultOptions"}}}}},"computed":false,"property":{"type":"Identifier","name":"bind"}},"arguments":[{"type":"ThisExpression"}]}}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"rateLimitedQueue"}},"operator":"??","right":{"type":"NewExpression","callee":{"type":"Identifier","name":"RateLimitedQueue"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"limit"}}]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"companionCommunicationQueue"}}},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"HTTPCommunicationQueue"},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setS3MultipartState"}}},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getFile"}}}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderSockets"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}}],"directives":[]}},{"type":"ClassMethod","accessibility":"private","static":false,"computed":true,"key":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getClient"}]},"kind":"method","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"setOptions"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"newOptions","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"companionCommunicationQueue"}}},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"Identifier","name":"newOptions"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Super"},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"Identifier","name":"newOptions"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setCompanionHeaders"}}},"arguments":[]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"resetUploaderReferences"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"fileID","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"Identifier","name":"opts","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"abort"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}]}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}}},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"really"},"computed":false,"shorthand":false,"value":{"type":"LogicalExpression","left":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"abort"},"optional":true},"operator":"||","right":{"type":"BooleanLiteral","value":false}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}}},"computed":false,"property":{"type":"Identifier","name":"remove"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderSockets"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderSockets"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"computed":false,"property":{"type":"Identifier","name":"close"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderSockets"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"assertHost"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"method","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"companionUrl"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"method"}],"quasis":[{"type":"TemplateElement","value":{"raw":"Expected a \\`companionUrl\\` option containing a Companion address, or if you are not using Companion, a custom \\`","cooked":"Expected a `companionUrl` option containing a Companion address, or if you are not using Companion, a custom `"},"tail":false},{"type":"TemplateElement","value":{"raw":"\\` implementation.","cooked":"` implementation."},"tail":true}]}]}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"signal","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"createMultipartUpload"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"allowedMetaFields"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetaFields"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"metadata"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetadata"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"meta"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"allowedMetaFields"}}]}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"post"}},"arguments":[{"type":"StringLiteral","value":"s3/multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"filename"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"name"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"type"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"metadata"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"metadata"}}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResultWithSignal"}}}},{"type":"Identifier","name":"oldSignal","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Part"}}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"??=","left":{"type":"Identifier","name":"signal"},"right":{"type":"Identifier","name":"oldSignal"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"listParts"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filename"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"key"}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"get"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"uploadId"},{"type":"Identifier","name":"filename"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/multipart/","cooked":"s3/multipart/"},"tail":false},{"type":"TemplateElement","value":{"raw":"?key=","cooked":"?key="},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Part"}}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"parts"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"parts"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartUploadResultWithSignal"}}}},{"type":"Identifier","name":"oldSignal","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"??=","left":{"type":"Identifier","name":"signal"},"right":{"type":"Identifier","name":"oldSignal"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"completeMultipartUpload"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filename"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"key"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadIdEnc"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"uploadId"}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"post"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"uploadIdEnc"},{"type":"Identifier","name":"filename"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/multipart/","cooked":"s3/multipart/"},"tail":false},{"type":"TemplateElement","value":{"raw":"/complete?key=","cooked":"/complete?key="},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"parts"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"parts"}}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}},"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3STSResponse"}}]}}},"value":null},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"getTemporarySecurityCredentials"}},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"options","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestOptions"}}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"options"},"computed":false,"property":{"type":"Identifier","name":"signal"},"optional":true}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"operator":"==","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"getTemporarySecurityCredentials"}},"operator":"===","right":{"type":"BooleanLiteral","value":true}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"getTemporarySecurityCredentials"}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"get"}},"arguments":[{"type":"StringLiteral","value":"s3/sts"},{"type":"Identifier","name":"options"}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3STSResponse"}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"getTemporarySecurityCredentials"}},"arguments":[{"type":"Identifier","name":"options"}]}}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"right":{"type":"AwaitExpression","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}}}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"setTimeout"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"right":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}}}],"directives":[]}},{"type":"BinaryExpression","left":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"Identifier","name":"getExpiry"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"computed":false,"property":{"type":"Identifier","name":"credentials"}}]},"operator":"||","right":{"type":"NumericLiteral","value":0}},"operator":"*","right":{"type":"NumericLiteral","value":500}}]}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"createSignedURL"},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"SignPartOptions"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"data"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getTemporarySecurityCredentials"}}},"arguments":[{"type":"Identifier","name":"options"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"expires"},"init":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"Identifier","name":"getExpiry"},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"credentials"}}]},"operator":"||","right":{"type":"NumericLiteral","value":604800}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"partNumber"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"partNumber"}}]},"init":{"type":"Identifier","name":"options"}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"expires"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"expires"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"fields"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"createSignedURL"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"accountKey"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"credentials"}},"computed":false,"property":{"type":"Identifier","name":"AccessKeyId"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"accountSecret"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"credentials"}},"computed":false,"property":{"type":"Identifier","name":"SecretAccessKey"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"sessionToken"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"credentials"}},"computed":false,"property":{"type":"Identifier","name":"SessionToken"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"expires"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"expires"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bucketName"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"bucket"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Region"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"region"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Key"},"computed":false,"shorthand":false,"value":{"type":"LogicalExpression","left":{"type":"Identifier","name":"key"},"operator":"??","right":{"type":"TemplateLiteral","expressions":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"crypto"},"computed":false,"property":{"type":"Identifier","name":"randomUUID"}},"arguments":[]},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"name"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":"-","cooked":"-"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"partNumber"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"partNumber"}}]}]}}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"headers"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"Content-Type"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"type"}},"typeAnnotation":{"type":"TSStringKeyword"}}}]}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"partNumber"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"partNumber"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"SignPartOptions"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"signPart"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"Identifier","name":"uploadId"},"operator":"==","right":{"type":"NullLiteral"}},"operator":"||","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"key"},"operator":"==","right":{"type":"NullLiteral"}}},"operator":"||","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"partNumber"},"operator":"==","right":{"type":"NullLiteral"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Cannot sign without a key, an uploadId, and a partNumber"}]}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filename"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"key"}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"get"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"uploadId"},{"type":"Identifier","name":"partNumber"},{"type":"Identifier","name":"filename"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/multipart/","cooked":"s3/multipart/"},"tail":false},{"type":"TemplateElement","value":{"raw":"/","cooked":"/"},"tail":false},{"type":"TemplateElement","value":{"raw":"?key=","cooked":"?key="},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResultWithSignal"}}}},{"type":"Identifier","name":"oldSignal","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"??=","left":{"type":"Identifier","name":"signal"},"right":{"type":"Identifier","name":"oldSignal"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"abortMultipartUpload"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filename"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"key"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadIdEnc"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"uploadId"}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"delete"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"uploadIdEnc"},{"type":"Identifier","name":"filename"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/multipart/","cooked":"s3/multipart/"},"tail":false},{"type":"TemplateElement","value":{"raw":"?key=","cooked":"?key="},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"Identifier","name":"undefined"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestOptions"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"meta"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"meta"}}]},"init":{"type":"Identifier","name":"file"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"type"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"name"},"computed":false,"method":false,"shorthand":false,"value":{"type":"Identifier","name":"filename"}}]},"init":{"type":"Identifier","name":"meta"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"allowedMetaFields"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetaFields"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"metadata"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetadata"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"meta"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"meta"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"querify"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"query"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"URLSearchParams"},"arguments":[{"type":"TSAsExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"filename"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"filename"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"metadata"}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"get"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"query"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/params?","cooked":"s3/params?"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"Identifier","name":"options"}]}}],"directives":[]}},{"type":"ClassMethod","static":true,"key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"signature"},"computed":false,"method":false,"shorthand":false,"value":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"url"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"url"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"expires"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"expires"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"headers"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"headers"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"method"},"computed":false,"method":false,"shorthand":true,"value":{"type":"AssignmentPattern","left":{"type":"Identifier","name":"method"},"right":{"type":"StringLiteral","value":"PUT"}}}]}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"body"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"body"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"size"},"computed":false,"method":false,"shorthand":true,"value":{"type":"AssignmentPattern","left":{"type":"Identifier","name":"size"},"right":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"body"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}},"computed":false,"property":{"type":"Identifier","name":"size"}}}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"onProgress"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"onProgress"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"onComplete"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"onComplete"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signature"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"body"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"FormData"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"size"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onProgress"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onComplete"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadPartBytesResult"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"url"},"operator":"==","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Cannot upload to an undefined URL"}]}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"reject"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"xhr"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"XMLHttpRequest"},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"open"}},"arguments":[{"type":"Identifier","name":"method"},{"type":"Identifier","name":"url"},{"type":"BooleanLiteral","value":true}]}},{"type":"IfStatement","test":{"type":"Identifier","name":"headers"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"keys"}},"arguments":[{"type":"Identifier","name":"headers"}]},"computed":false,"property":{"type":"Identifier","name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"key"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"setRequestHeader"}},"arguments":[{"type":"Identifier","name":"key"},{"type":"MemberExpression","object":{"type":"Identifier","name":"headers"},"computed":true,"property":{"type":"Identifier","name":"key"}}]}}],"directives":[]}}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"responseType"}},"right":{"type":"StringLiteral","value":"text"}}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"Identifier","name":"expires"}},"operator":"===","right":{"type":"StringLiteral","value":"number"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"timeout"}},"right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"expires"},"operator":"*","right":{"type":"NumericLiteral","value":1000}}}}],"directives":[]},"alternate":null},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"onabort"},"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"cleanup"},"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"signal"},"computed":false,"property":{"type":"Identifier","name":"removeEventListener"},"optional":true},"optional":false,"arguments":[{"type":"StringLiteral","value":"abort"},{"type":"Identifier","name":"onabort"}]}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"signal"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"},"optional":true},"optional":false,"arguments":[{"type":"StringLiteral","value":"abort"},{"type":"Identifier","name":"onabort"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"progress"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"ev"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"onProgress"},"arguments":[{"type":"Identifier","name":"ev"}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"abort"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"cleanup"},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"CallExpression","callee":{"type":"Identifier","name":"createAbortError"},"arguments":[]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"timeout"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"cleanup"},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Request has expired"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"error"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"source"}},"right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":403}}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"error"}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"load"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"cleanup"},"arguments":[]}},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"status"}},"operator":"===","right":{"type":"NumericLiteral","value":403}},"operator":"&&","right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"responseText"}},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"<Message>Request has expired</Message>"}]}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Request has expired"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"error"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"source"}},"right":{"type":"Identifier","name":"xhr"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"error"}]}},{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"status"}},"operator":"<","right":{"type":"NumericLiteral","value":200}},"operator":"||","right":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"status"}},"operator":">=","right":{"type":"NumericLiteral","value":300}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Non 2xx"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"error"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"source"}},"right":{"type":"Identifier","name":"xhr"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"error"}]}},{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"Identifier","name":"onProgress"},"optional":true,"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"loaded"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"size"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"lengthComputable"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"etag"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"getResponseHeader"}},"arguments":[{"type":"StringLiteral","value":"ETag"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"location"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"getResponseHeader"}},"arguments":[{"type":"StringLiteral","value":"Location"}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"method"},"computed":false,"property":{"type":"Identifier","name":"toUpperCase"}},"arguments":[]},"operator":"===","right":{"type":"StringLiteral","value":"POST"}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"location"},"operator":"===","right":{"type":"NullLiteral"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"warn"}},"arguments":[{"type":"StringLiteral","value":"AwsS3/Multipart: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"etag"},"operator":"===","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."}]}]}},{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"Identifier","name":"onComplete"},"optional":true,"arguments":[{"type":"Identifier","name":"etag"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"etag"}},{"type":"SpreadElement","argument":{"type":"ConditionalExpression","test":{"type":"Identifier","name":"location"},"consequent":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"location"}}]},"alternate":{"type":"Identifier","name":"undefined"}}}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"error"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"ev"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"cleanup"},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Unknown error"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"error"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"source"}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"ev"},"computed":false,"property":{"type":"Identifier","name":"target"}}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"error"}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"send"}},"arguments":[{"type":"Identifier","name":"body"}]}}],"directives":[]}}]}}],"directives":[]}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"setS3MultipartState"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"cFile"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"cFile"},"operator":"==","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setFileState"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"TSAsExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"s3Multipart"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"cFile"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}},"computed":false,"property":{"type":"Identifier","name":"s3Multipart"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}}]}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}}}]}}],"directives":[]}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"getFile"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]},"operator":"||","right":{"type":"Identifier","name":"file"}}}],"directives":[]}}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadLocalFile"}},"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSUnionType","types":[{"type":"TSVoidKeyword"},{"type":"TSStringKeyword"}]}]},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"reject"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"onProgress"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"bytesUploaded","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"Identifier","name":"bytesTotal","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-progress"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploader"},"computed":false,"shorthand":false,"value":{"type":"ThisExpression"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bytesUploaded"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"bytesUploaded"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bytesTotal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"bytesTotal"}}]}]}}],"directives":[]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"onError"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnknownKeyword"}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TSAsExpression","expression":{"type":"Identifier","name":"err"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Error"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-error"},{"type":"Identifier","name":"file"},{"type":"TSAsExpression","expression":{"type":"Identifier","name":"err"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Error"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"err"}]}}],"directives":[]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"onSuccess"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"result","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadResp"},"init":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"body"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"result"}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":200}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadURL"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"result"},"computed":false,"property":{"type":"Identifier","name":"location"}}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-success"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getFile"}}},"arguments":[{"type":"Identifier","name":"file"}]},{"type":"Identifier","name":"uploadResp"}]}},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"result"},"computed":false,"property":{"type":"Identifier","name":"location"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"name"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"result"},"computed":false,"property":{"type":"Identifier","name":"location"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"Download ","cooked":"Download "},"tail":false},{"type":"TemplateElement","value":{"raw":" from ","cooked":" from "},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[]}}],"directives":[]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"upload"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"MultipartUploader"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionComm"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"companionCommunicationQueue"}}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"log"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"RestElement","argument":{"type":"Identifier","name":"args"},"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Parameters"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Uppy"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"log"}}}]}}}}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"args"}}]}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getChunkSize"},"computed":false,"shorthand":false,"value":{"type":"ConditionalExpression","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"getChunkSize"}},"consequent":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"getChunkSize"}},"computed":false,"property":{"type":"Identifier","name":"bind"}},"arguments":[{"type":"ThisExpression"}]},"alternate":{"type":"NullLiteral"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onProgress"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"onProgress"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onError"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"onError"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onSuccess"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"onSuccess"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onPartComplete"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"part"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"s3-multipart:part-uploaded"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getFile"}}},"arguments":[{"type":"Identifier","name":"file"}]},{"type":"Identifier","name":"part"}]}}],"directives":[]}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"file"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"file"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"shouldUseMultipart"}}},{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"file"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}},"computed":false,"property":{"type":"Identifier","name":"s3Multipart"}}}]}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"right":{"type":"Identifier","name":"upload"}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"eventManager"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"EventManager"},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"right":{"type":"Identifier","name":"eventManager"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onFileRemove"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"removed"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abort"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"removed"}],"quasis":[{"type":"TemplateElement","value":{"raw":"upload ","cooked":"upload "},"tail":false},{"type":"TemplateElement","value":{"raw":" was removed","cooked":" was removed"},"tail":true}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onCancelAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"options"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"options"},"computed":false,"property":{"type":"Identifier","name":"reason"},"optional":true},"operator":"===","right":{"type":"StringLiteral","value":"user"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abort"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"upload ","cooked":"upload "},"tail":false},{"type":"TemplateElement","value":{"raw":" was canceled","cooked":" was canceled"},"tail":true}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onFilePause"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"isPaused"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"Identifier","name":"isPaused"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"pause"}},"arguments":[]}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"start"}},"arguments":[]}}],"directives":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onPauseAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"pause"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onResumeAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"start"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"start"}},"arguments":[]}}],"directives":[]}}]}}],"directives":[]}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"getCompanionClientArgs"}},"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"remote"}},"computed":false,"property":{"type":"Identifier","name":"body"},"optional":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"protocol"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"s3-multipart"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"size"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"size"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"metadata"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}}]}}],"directives":[]}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"upload"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"fileIDs","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileIDs"},"computed":false,"property":{"type":"Identifier","name":"length"}},"operator":"===","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"ReturnStatement","argument":{"type":"Identifier","name":"undefined"}},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"files"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFilesByIds"}},"arguments":[{"type":"Identifier","name":"fileIDs"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesFiltered"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"filterNonFailedFiles"},"arguments":[{"type":"Identifier","name":"files"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesToEmit"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"},"arguments":[{"type":"Identifier","name":"filesFiltered"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-start"},{"type":"Identifier","name":"filesToEmit"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"promises"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"filesFiltered"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isRemote"}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"getQueue"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}}},"arguments":[{"type":"BooleanLiteral","value":false}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"controller"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"AbortController"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"removedHandler"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"removedFile","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"removedFile"},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"===","right":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"controller"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},"alternate":null}],"directives":[]}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"file-removed"},{"type":"Identifier","name":"removedHandler"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadPromise"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getRequestClientForFile"}},"arguments":[{"type":"Identifier","name":"file"}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestClient"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},"computed":false,"property":{"type":"Identifier","name":"uploadRemoteFile"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getCompanionClientArgs"}}},"arguments":[{"type":"Identifier","name":"file"}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"controller"},"computed":false,"property":{"type":"Identifier","name":"signal"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getQueue"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"getQueue"}}]}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"wrapSyncFunction"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"off"}},"arguments":[{"type":"StringLiteral","value":"file-removed"},{"type":"Identifier","name":"removedHandler"}]}}],"directives":[]}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"priority"},"computed":false,"shorthand":false,"value":{"type":"UnaryExpression","operator":"-","prefix":true,"argument":{"type":"NumericLiteral","value":1}}}]}]},"arguments":[]}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"uploadPromise"}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadLocalFile"}}},"arguments":[{"type":"Identifier","name":"file"}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"upload"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"all"}},"arguments":[{"type":"Identifier","name":"promises"}]}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"upload"}}],"directives":[]}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"setCompanionHeaders"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"setCompanionHeaders"}},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"companionHeaders"}}]}}],"directives":[]}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"boolean","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"capabilities"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"capabilities"}}]},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getState"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setState"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"capabilities"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"capabilities"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"resumableUploads"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"boolean"}}]}}]}]}}],"directives":[]}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"resetResumableCapability"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}}},"arguments":[{"type":"BooleanLiteral","value":true}]}}],"directives":[]}}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"install"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"addPreProcessor"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setCompanionHeaders"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"addUploader"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"upload"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"cancel-all"},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"resetResumableCapability"}}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"uninstall"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"removePreProcessor"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setCompanionHeaders"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"removeUploader"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"upload"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"off"}},"arguments":[{"type":"StringLiteral","value":"cancel-all"},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"resetResumableCapability"}}}]}}],"directives":[]}}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"uploadPartBytes"},"typeAnnotation":{"type":"TSIndexedAccessType","objectType":{"type":"TSParenthesizedType","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"uploadPartBytes"}}}}}],"directives":[]}}},"after":{"packages/@uppy/aws-s3/src/index.test.ts":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"module","interpreter":null,"body":[{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"afterEach"},"importKind":"value","local":{"type":"Identifier","name":"afterEach"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"beforeEach"},"importKind":"value","local":{"type":"Identifier","name":"beforeEach"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"describe"},"importKind":"value","local":{"type":"Identifier","name":"describe"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"expect"},"importKind":"value","local":{"type":"Identifier","name":"expect"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"it"},"importKind":"value","local":{"type":"Identifier","name":"it"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"vi"},"importKind":"value","local":{"type":"Identifier","name":"vi"}}],"source":{"type":"StringLiteral","value":"vitest"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[],"source":{"type":"StringLiteral","value":"whatwg-fetch"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"nock"}}],"source":{"type":"StringLiteral","value":"nock"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"Core"}}],"source":{"type":"StringLiteral","value":"@uppy/core"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"AwsS3Multipart"}}],"source":{"type":"StringLiteral","value":"./index.ts"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"Body"}}],"source":{"type":"StringLiteral","value":"./utils.ts"}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"KB"},"init":{"type":"NumericLiteral","value":1024}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"MB"},"init":{"type":"BinaryExpression","left":{"type":"Identifier","name":"KB"},"operator":"*","right":{"type":"Identifier","name":"KB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"beforeEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"nock"},"computed":false,"property":{"type":"Identifier","name":"disableNetConnect"}},"arguments":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"Registers AwsS3Multipart upload plugin"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"pluginNames"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getPlugins"}]}},"arguments":[{"type":"StringLiteral","value":"uploader"}]},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"plugin","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}}],"body":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"plugin"},"computed":false,"property":{"type":"Identifier","name":"constructor"}},"computed":false,"property":{"type":"Identifier","name":"name"}}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"pluginNames"}]},"computed":false,"property":{"type":"Identifier","name":"toContain"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"companionUrl assertion"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"Throws an error for main functions if configured without companionUrl"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart"},"init":{"type":"TSNonNullExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"err"},"init":{"type":"StringLiteral","value":"Expected a `companionUrl` option"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"file"},"init":{"type":"ObjectExpression","properties":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"opts"},"init":{"type":"ObjectExpression","properties":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}},"arguments":[{"type":"Identifier","name":"file"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"listParts"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"opts"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"completeMultipartUpload"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"opts"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"abortMultipartUpload"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"opts"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"opts"}]}}]},"computed":false,"property":{"type":"Identifier","name":"toThrow"}},"arguments":[{"type":"Identifier","name":"err"}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"non-multipart upload"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"should handle POST uploads"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":0}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"POST"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com/"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"fields"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}}]}}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scope"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"POST"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag, Location"}}]}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"options"}},"arguments":[{"type":"StringLiteral","value":"/"}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":204},{"type":"StringLiteral","value":""}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"post"}},"arguments":[{"type":"StringLiteral","value":"/"}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":201},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"http://example.com"}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"NumericLiteral","value":1}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadSuccessHandler"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"upload-success"},{"type":"Identifier","name":"uploadSuccessHandler"}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadSuccessHandler"},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}}]},"computed":false,"property":{"type":"Identifier","name":"toHaveLength"}},"arguments":[{"type":"NumericLiteral","value":1}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadSuccessHandler"},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":true,"property":{"type":"NumericLiteral","value":0}},"computed":true,"property":{"type":"NumericLiteral","value":1}}]},"computed":false,"property":{"type":"Identifier","name":"toStrictEqual"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"body"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"http://example.com"}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":200}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadURL"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"http://example.com"}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"done"}},"arguments":[]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"without companionUrl (custom main functions)"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"beforeEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":0}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"6aeb1980f3fc7ce0b5454d25b71992"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test/upload/multitest.dat"}}]}}],"directives":[]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"file"},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"number"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"number"}}]}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"number"}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"headers"},"computed":false,"shorthand":false,"value":{"type":"ConditionalExpression","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"number"},"operator":"===","right":{"type":"NumericLiteral","value":1}},"consequent":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"Content-MD5"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"foo"}}]},"alternate":{"type":"Identifier","name":"undefined"}}}]}}],"directives":[]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"undefined"},"typeAnnotation":{"type":"TSAnyKeyword"}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"awsS3Multipart"},"right":{"type":"TSAsExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]},"typeAnnotation":{"type":"TSAnyKeyword"}}}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"Keeps chunks marked as busy through retries until they complete"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scope"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag"}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":50},"operator":"*","right":{"type":"Identifier","name":"MB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"options"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]},"operator":"&&","right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"partNumber=7"}]}}}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"calls"},"init":{"type":"NumericLiteral","value":0}}],"kind":"let"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]},"operator":"&&","right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"partNumber=7"}]}}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"ConditionalExpression","test":{"type":"BinaryExpression","left":{"type":"UpdateExpression","operator":"++","prefix":false,"argument":{"type":"Identifier","name":"calls"}},"operator":"===","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":500}]},"alternate":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"scope"},"computed":false,"property":{"type":"Identifier","name":"persist"}},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"busySpy"},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"doneSpy"},"init":null}],"kind":"let"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":10}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"multipartUploader"},"init":{"type":"TSNonNullExpression","expression":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"testChunkState"},"init":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"multipartUploader"},"computed":false,"property":{"type":"Identifier","name":"chunkState"}},"computed":true,"property":{"type":"NumericLiteral","value":6}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"busy"},"init":{"type":"BooleanLiteral","value":false}}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"done"},"init":{"type":"BooleanLiteral","value":false}}],"kind":"let"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"busySpy"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"value"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"busy"},"right":{"type":"Identifier","name":"value"}}}],"directives":[]}}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"doneSpy"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"value"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"done"},"right":{"type":"Identifier","name":"value"}}}],"directives":[]}}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"defineProperty"}},"arguments":[{"type":"Identifier","name":"testChunkState"},{"type":"StringLiteral","value":"busy"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"get"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"Identifier","name":"busy"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"set"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"busySpy"}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"defineProperty"}},"arguments":[{"type":"Identifier","name":"testChunkState"},{"type":"StringLiteral","value":"done"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"get"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"Identifier","name":"done"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"set"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"doneSpy"}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"6aeb1980f3fc7ce0b5454d25b71992"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test/upload/multitest.dat"}}]}}],"directives":[]}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"doneSpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":1}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"doneSpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":true,"property":{"type":"NumericLiteral","value":0}},"computed":true,"property":{"type":"NumericLiteral","value":0}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"doneCallOrderNumber"},"init":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"doneSpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"invocationCallOrder"}},"computed":true,"property":{"type":"NumericLiteral","value":0}}}],"kind":"const"},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ArrayPattern","elements":[{"type":"Identifier","name":"index"},{"type":"Identifier","name":"callArgs"}]},"init":null}],"kind":"const"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"busySpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"entries"}},"arguments":[]},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"callArgs"},"computed":true,"property":{"type":"NumericLiteral","value":0}},"operator":"===","right":{"type":"BooleanLiteral","value":false}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"Identifier","name":"busySpy"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"invocationCallOrder"}},"computed":true,"property":{"type":"Identifier","name":"index"}}]},"computed":false,"property":{"type":"Identifier","name":"toBeGreaterThan"}},"arguments":[{"type":"Identifier","name":"doneCallOrderNumber"}]}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":10}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"MultipartUploader"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"createMultipartUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"6aeb1980f3fc7ce0b5454d25b71992"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test/upload/multitest.dat"}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"signPart"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"file"},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"partNumber"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"partNumber"}}]}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"partNumber"}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadPartBytes"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"afterEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"clearAllMocks"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"retries uploadPartBytes when it fails once"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"StringLiteral","value":"should ignore"}}],"directives":[]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signPart"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"property":{"type":"Identifier","name":"mockImplementationOnce"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"reject"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":500}}]}}]}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"undefined"},"typeAnnotation":{"type":"TSAnyKeyword"}}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart"},"init":{"type":"TSNonNullExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":5},"operator":"*","right":{"type":"Identifier","name":"MB"}},"operator":"+","right":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":1},"operator":"*","right":{"type":"Identifier","name":"MB"}}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"uploadPartBytes"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":3}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"calls `upload-error` when uploadPartBytes fails after all retries"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":10}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signPart"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"property":{"type":"Identifier","name":"mockImplementation"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"reject"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":500}}]}}]}]}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"undefined"},"typeAnnotation":{"type":"TSAnyKeyword"}}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart"},"init":{"type":"TSNonNullExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":5},"operator":"*","right":{"type":"Identifier","name":"MB"}},"operator":"+","right":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":1},"operator":"*","right":{"type":"Identifier","name":"MB"}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"mock"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"upload-error"},{"type":"Identifier","name":"mock"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}]},"computed":false,"property":{"type":"Identifier","name":"rejects"}},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":500}}]}}]}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"uploadPartBytes"}},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":3}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"mock"},"computed":false,"property":{"type":"Identifier","name":"mock"}},"computed":false,"property":{"type":"Identifier","name":"calls"}},"computed":false,"property":{"type":"Identifier","name":"length"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"NumericLiteral","value":1}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"dynamic companionHeader"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"oldToken"},"init":{"type":"StringLiteral","value":"old token"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"newToken"},"init":{"type":"StringLiteral","value":"new token"}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"beforeEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionUrl"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":""}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"authorization"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"oldToken"}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"awsS3Multipart"},"right":{"type":"TSAsExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]},"typeAnnotation":{"type":"TSAnyKeyword"}}}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"companionHeader is updated before uploading file"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"authorization"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"newToken"}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"client"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getClient"}]}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"client"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getCompanionHeaders"}]}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"authorization"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"Identifier","name":"newToken"}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"dynamic companionHeader using setOption"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"awsS3Multipart","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"newToken"},"init":{"type":"StringLiteral","value":"new token"}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"companionHeader is updated before uploading file"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addPreProcessor"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"awsS3Multipart"},"right":{"type":"TSAsExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"getPlugin"}},"arguments":[{"type":"StringLiteral","value":"AwsS3Multipart"}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"authorization"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"newToken"}}]}}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"client"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"awsS3Multipart"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getClient"}]}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"client"},"computed":true,"property":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getCompanionHeaders"}]}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"authorization"}}]},"computed":false,"property":{"type":"Identifier","name":"toEqual"}},"arguments":[{"type":"Identifier","name":"newToken"}]}}],"directives":[]}}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"describe"},"arguments":[{"type":"StringLiteral","value":"file metadata across custom main functions"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"core","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"createMultipartUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"upload1234"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"name"}}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"signPart"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"partData"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"computed":true,"key":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"listParts"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"partKeys"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"keys"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}]},"computed":false,"property":{"type":"Identifier","name":"filter"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"metaKey"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"metaKey"},"computed":false,"property":{"type":"Identifier","name":"startsWith"}},"arguments":[{"type":"StringLiteral","value":"part"}]}}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"partKeys"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"metaKey"}],"body":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"PartNumber"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":true,"property":{"type":"Identifier","name":"metaKey"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"metaKey"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Size"},"computed":false,"shorthand":false,"value":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":5},"operator":"*","right":{"type":"Identifier","name":"MB"}}}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"completeMultipartUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ForStatement","init":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"i"},"init":{"type":"NumericLiteral","value":1}}],"kind":"let"},"test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"i"},"operator":"<=","right":{"type":"NumericLiteral","value":10}},"update":{"type":"UpdateExpression","operator":"++","prefix":false,"argument":{"type":"Identifier","name":"i"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":true,"property":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"i"}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"Identifier","name":"i"}]}}],"directives":[]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"abortMultipartUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"abortingPart"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"NumericLiteral","value":5}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"beforeEach"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"signPart"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"listParts"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"property":{"type":"Identifier","name":"mockClear"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"preserves file metadata if upload is completed"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signPart"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"listParts"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"completeMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"abortMultipartUpload"}}]}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag"}}]}]},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]},"computed":false,"property":{"type":"Identifier","name":"persist"}},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":50},"operator":"*","right":{"type":"Identifier","name":"MB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"createMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"signPart"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalledTimes"}},"arguments":[{"type":"NumericLiteral","value":11}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"completeMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"preserves file metadata if upload is aborted"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"signPartWithAbort"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"partData"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}},"operator":"===","right":{"type":"NumericLiteral","value":5}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortingPart"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"removeFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"undefined"},"typeAnnotation":{"type":"TSAnyKeyword"}},"typeAnnotation":{"type":"TSStringKeyword"}}}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"computed":true,"key":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"signPartWithAbort"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"listParts"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"completeMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"abortMultipartUpload"}}]}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag"}}]}]},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]},"computed":false,"property":{"type":"Identifier","name":"persist"}},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":50},"operator":"*","right":{"type":"Identifier","name":"MB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"createMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"signPartWithAbort"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"abortMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"it"},"arguments":[{"type":"StringLiteral","value":"preserves file metadata if upload is paused and resumed"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"completeMultipartUploadAfterPause"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"signPart"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ForStatement","init":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"i"},"init":{"type":"NumericLiteral","value":1}}],"kind":"let"},"test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"i"},"operator":"<=","right":{"type":"NumericLiteral","value":10}},"update":{"type":"UpdateExpression","operator":"++","prefix":false,"argument":{"type":"Identifier","name":"i"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":true,"property":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"i"}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"Identifier","name":"i"}]}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"listParts"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"signPartWithPause"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"vi"},"computed":false,"property":{"type":"Identifier","name":"fn"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"},{"type":"Identifier","name":"partData"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}]},"computed":false,"property":{"type":"Identifier","name":"toBe"}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}},"operator":"===","right":{"type":"NumericLiteral","value":3}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortingPart"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"pauseResume"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"setTimeout"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"pauseResume"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"NumericLiteral","value":500}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"setFileMeta"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"computed":true,"key":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"part","cooked":"part"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}}]}]}},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"partData"},"computed":false,"property":{"type":"Identifier","name":"partNumber"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber=","cooked":"https://bucket.s3.us-east-2.amazonaws.com/test/upload/multitest.dat?partNumber="},"tail":false},{"type":"TemplateElement","value":{"raw":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test","cooked":"&uploadId=6aeb1980f3fc7ce0b5454d25b71992&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATEST%2F20210729%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20210729T014044Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=test"},"tail":true}]}}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"core"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Core"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}]},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"use"}},"arguments":[{"type":"Identifier","name":"AwsS3Multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"createMultipartUpload"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"signPartWithPause"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"listParts"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"completeMultipartUploadAfterPause"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"abortMultipartUpload"}}]}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"nock"},"arguments":[{"type":"StringLiteral","value":"https://bucket.s3.us-east-2.amazonaws.com"}]},"computed":false,"property":{"type":"Identifier","name":"defaultReplyHeaders"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-allow-origin"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"*"}},{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"access-control-expose-headers"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"ETag"}}]}]},"computed":false,"property":{"type":"Identifier","name":"put"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uri"}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri"},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"test/upload/multitest.dat"}]}}]},"computed":false,"property":{"type":"Identifier","name":"reply"}},"arguments":[{"type":"NumericLiteral","value":200},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"test"}}]}]},"computed":false,"property":{"type":"Identifier","name":"persist"}},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileSize"},"init":{"type":"BinaryExpression","left":{"type":"NumericLiteral","value":50},"operator":"*","right":{"type":"Identifier","name":"MB"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"addFile"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"source"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"vi"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"multitest.dat"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"NewExpression","callee":{"type":"Identifier","name":"File"},"arguments":[{"type":"ArrayExpression","elements":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Uint8Array"},"arguments":[{"type":"Identifier","name":"fileSize"}]}]},{"type":"StringLiteral","value":""},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"application/octet-stream"}}]}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"core"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"createMultipartUpload"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"signPartWithPause"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"listParts"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"Identifier","name":"expect"},"arguments":[{"type":"Identifier","name":"completeMultipartUploadAfterPause"}]},"computed":false,"property":{"type":"Identifier","name":"toHaveBeenCalled"}},"arguments":[]}}],"directives":[]}}]}}],"directives":[]}}]}}],"directives":[]}}]}}],"directives":[]}},"packages/@uppy/aws-s3/src/index.ts":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"module","interpreter":null,"body":[{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"BasePlugin"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"DefinePluginOpts"},"local":{"type":"Identifier","name":"DefinePluginOpts"},"importKind":"type"},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"PluginOpts"},"local":{"type":"Identifier","name":"PluginOpts"},"importKind":"type"}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/BasePlugin.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RequestClient"},"importKind":"value","local":{"type":"Identifier","name":"RequestClient"}}],"source":{"type":"StringLiteral","value":"@uppy/companion-client"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RequestOptions"},"importKind":"value","local":{"type":"Identifier","name":"RequestOptions"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/CompanionClientProvider"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"_Body"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Meta"},"importKind":"value","local":{"type":"Identifier","name":"Meta"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UppyFile"},"importKind":"value","local":{"type":"Identifier","name":"UppyFile"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/UppyFile"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Uppy"},"importKind":"value","local":{"type":"Identifier","name":"Uppy"}}],"source":{"type":"StringLiteral","value":"@uppy/core"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"EventManager"}}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/EventManager.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RateLimitedQueue"},"importKind":"value","local":{"type":"Identifier","name":"RateLimitedQueue"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/RateLimitedQueue"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"filterNonFailedFiles"},"importKind":"value","local":{"type":"Identifier","name":"filterNonFailedFiles"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"},"importKind":"value","local":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/fileFilters"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"createAbortError"},"importKind":"value","local":{"type":"Identifier","name":"createAbortError"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/AbortController"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"getAllowedMetaFields"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/getAllowedMetaFields"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"MultipartUploader"}}],"source":{"type":"StringLiteral","value":"./MultipartUploader.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"throwIfAborted"},"importKind":"value","local":{"type":"Identifier","name":"throwIfAborted"}}],"source":{"type":"StringLiteral","value":"./utils.ts"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UploadResult"},"importKind":"value","local":{"type":"Identifier","name":"UploadResult"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UploadResultWithSignal"},"importKind":"value","local":{"type":"Identifier","name":"UploadResultWithSignal"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"MultipartUploadResultWithSignal"},"importKind":"value","local":{"type":"Identifier","name":"MultipartUploadResultWithSignal"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UploadPartBytesResult"},"importKind":"value","local":{"type":"Identifier","name":"UploadPartBytesResult"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"Body"}}],"source":{"type":"StringLiteral","value":"./utils.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"createSignedURL"}}],"source":{"type":"StringLiteral","value":"./createSignedURL.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"HTTPCommunicationQueue"},"importKind":"value","local":{"type":"Identifier","name":"HTTPCommunicationQueue"}}],"source":{"type":"StringLiteral","value":"./HTTPCommunicationQueue.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"packageJson"}}],"source":{"type":"StringLiteral","value":"../package.json"}},{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"MultipartFile"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"extends":[{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}],"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"s3Multipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"PartUploadedCallback"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"_Body"}}}]},"typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"part","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"PartNumber"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"ETag"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}},{"type":"TSModuleDeclaration","id":{"type":"StringLiteral","value":"@uppy/core"},"body":{"type":"TSModuleBlock","body":[{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"UppyEventMap"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"_Body"}}}]},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"StringLiteral","value":"s3-multipart:part-uploaded"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"PartUploadedCallback"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}]}}}]},"declare":true},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"assertServerError"},"generator":false,"async":false,"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"T"}]},"params":[{"type":"Identifier","name":"res","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"T"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"T"}}},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"OptionalMemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"res"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"error"},"optional":true},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"res"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"message"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"assign"}},"arguments":[{"type":"Identifier","name":"error"},{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"res"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"error"}}]}},{"type":"ThrowStatement","argument":{"type":"Identifier","name":"error"}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"res"}}],"directives":[]}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"AwsS3STSResponse"},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"credentials"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"AccessKeyId"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"SecretAccessKey"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"SessionToken"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"Expiration"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"bucket"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"region"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getExpiry"},"generator":false,"async":false,"params":[{"type":"Identifier","name":"credentials","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3STSResponse"}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"credentials"}}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSNumberKeyword"},{"type":"TSUndefinedKeyword"}]}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"expirationDate"},"init":{"type":"MemberExpression","object":{"type":"Identifier","name":"credentials"},"computed":false,"property":{"type":"Identifier","name":"Expiration"}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"Identifier","name":"expirationDate"},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"timeUntilExpiry"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Math"},"computed":false,"property":{"type":"Identifier","name":"floor"}},"arguments":[{"type":"BinaryExpression","left":{"type":"BinaryExpression","left":{"type":"TSAsExpression","expression":{"type":"TSAsExpression","expression":{"type":"NewExpression","callee":{"type":"Identifier","name":"Date"},"arguments":[{"type":"Identifier","name":"expirationDate"}]},"typeAnnotation":{"type":"TSAnyKeyword"}},"typeAnnotation":{"type":"TSNumberKeyword"}},"operator":"-","right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Date"},"computed":false,"property":{"type":"Identifier","name":"now"}},"arguments":[]}},"operator":"/","right":{"type":"NumericLiteral","value":1000}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"timeUntilExpiry"},"operator":">","right":{"type":"NumericLiteral","value":9}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"timeUntilExpiry"}}],"directives":[]},"alternate":null}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"undefined"}}],"directives":[]}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getAllowedMetadata"},"generator":false,"async":false,"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSAnyKeyword"}]}}}]},"params":[{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"meta"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"meta"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"querify"},"computed":false,"method":false,"shorthand":true,"value":{"type":"AssignmentPattern","left":{"type":"Identifier","name":"querify"},"right":{"type":"BooleanLiteral","value":false}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"meta"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}},{"type":"TSNullKeyword"}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"querify"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}]}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"metaFields"},"init":{"type":"LogicalExpression","left":{"type":"Identifier","name":"allowedMetaFields"},"operator":"??","right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"keys"}},"arguments":[{"type":"Identifier","name":"meta"}]}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"meta"}},"consequent":{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[]}},"alternate":null},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"fromEntries"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"metaFields"},"computed":false,"property":{"type":"Identifier","name":"filter"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"key"}],"body":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"meta"},"computed":true,"property":{"type":"Identifier","name":"key"}},"operator":"!=","right":{"type":"NullLiteral"}}}]},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"key"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"realKey"},"init":{"type":"ConditionalExpression","test":{"type":"Identifier","name":"querify"},"consequent":{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"key"}],"quasis":[{"type":"TemplateElement","value":{"raw":"metadata[","cooked":"metadata["},"tail":false},{"type":"TemplateElement","value":{"raw":"]","cooked":"]"},"tail":true}]},"alternate":{"type":"Identifier","name":"key"}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"value"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"String"},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"meta"},"computed":true,"property":{"type":"Identifier","name":"key"}}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"realKey"},{"type":"Identifier","name":"value"}]}}],"directives":[]}}]}]}}],"directives":[]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"T"}]},"typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"T"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"T"}}]}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"SignPartOptions"},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"uploadId"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"key"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"partNumber"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"body"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AwsS3UploadParameters"},"typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"method"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"POST"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"url"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"fields"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"expires"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"headers"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}}]},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"method"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"PUT"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"url"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"fields"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSNeverKeyword"}]}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"expires"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"headers"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}}]}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"AwsS3Part"},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"PartNumber"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"Size"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"ETag"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3WithCompanion"},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"companionUrl"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"companionCookiesRule"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":true}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3WithoutCompanion"},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"options","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3STSResponse"}}]}}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signature"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"body"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"FormData"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"size"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onProgress"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onComplete"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadPartBytesResult"}}]}}}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanionMandatory"},"typeAnnotation":{"type":"TSTypeLiteral","members":[]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestOptions"}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanion"},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanionMandatory"}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":false}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithoutCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":false}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatorySignPart"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signPart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"SignPartOptions"}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}}}}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"getChunkSize"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}]}}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"listParts"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResultWithSignal"}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Part"}}}]}}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResultWithSignal"}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]}}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"uploadId"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"key"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"parts"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Part"}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"location"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}]}]}}}}}}]},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatorySignPart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithoutCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":true}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MultipartWithCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":true}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MaybeMultipartWithCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanionMandatory"}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AWSS3MaybeMultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithoutCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}}}]}]}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"RequestClientOptions"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"ConstructorParameters"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"RequestClient"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}]}},"indexType":{"type":"TSLiteralType","literal":{"type":"NumericLiteral","value":1}}}]}}},{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"_AwsS3MultipartOptions"},"extends":[{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"PluginOpts"}},{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"RequestClientOptions"}}],"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}},{"type":"TSBooleanKeyword"}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"limit"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"retryDelays"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSArrayType","elementType":{"type":"TSNumberKeyword"}},{"type":"TSNullKeyword"}]}}}]}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"_AwsS3MultipartOptions"}},{"type":"TSParenthesizedType","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithCompanion"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MaybeMultipartWithCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MaybeMultipartWithoutCompanion"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}}]}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"defaultOptions"},"init":{"type":"TSSatisfiesExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":6}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"BooleanLiteral","value":false},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"TSAsExpression","expression":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}}}],"body":{"type":"BinaryExpression","left":{"type":"BinaryExpression","left":{"type":"BinaryExpression","left":{"type":"TSNonNullExpression","expression":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"size"}}},"operator":">>","right":{"type":"NumericLiteral","value":10}},"operator":">>","right":{"type":"NumericLiteral","value":10}},"operator":">","right":{"type":"NumericLiteral","value":100}}},"typeAnnotation":{"type":"TSAnyKeyword"}},"typeAnnotation":{"type":"TSLiteralType","literal":{"type":"BooleanLiteral","value":true}}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":0},{"type":"NumericLiteral","value":1000},{"type":"NumericLiteral","value":3000},{"type":"NumericLiteral","value":5000}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionHeaders"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}]}}}}],"kind":"const"},{"type":"ExportDefaultDeclaration","exportKind":"value","declaration":{"type":"ClassDeclaration","id":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"superClass":{"type":"Identifier","name":"BasePlugin"},"superTypeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSIntersectionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"DefinePluginOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"defaultOptions"}}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Pick"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSUnionType","types":[{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"getChunkSize"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"createMultipartUpload"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"listParts"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"abortMultipartUpload"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"completeMultipartUpload"}}]}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Required"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Pick"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3WithoutCompanion"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"uploadPartBytes"}}]}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3MultipartWithoutCompanionMandatorySignPart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AWSS3NonMultipartWithoutCompanionMandatory"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]},"body":{"type":"ClassBody","body":[{"type":"ClassProperty","static":true,"key":{"type":"Identifier","name":"VERSION"},"computed":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"packageJson"},"computed":false,"property":{"type":"Identifier","name":"version"}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"companionCommunicationQueue"}},"value":null},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}},"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestClient"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}},"value":null},{"type":"ClassProperty","accessibility":"protected","static":false,"key":{"type":"Identifier","name":"requests"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}},"value":null},{"type":"ClassProperty","accessibility":"protected","static":false,"key":{"type":"Identifier","name":"uploaderEvents"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"EventManager"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSNullKeyword"}]}]}}},"value":null},{"type":"ClassProperty","accessibility":"protected","static":false,"key":{"type":"Identifier","name":"uploaders"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartUploader"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSNullKeyword"}]}]}}},"value":null},{"type":"ClassProperty","accessibility":"protected","static":false,"key":{"type":"Identifier","name":"uploaderSockets"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSNeverKeyword"}]}}},"value":null},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"constructor"},"computed":false,"kind":"constructor","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uppy","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Uppy"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Super"},"arguments":[{"type":"Identifier","name":"uppy"},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"defaultOptions"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"AwsS3Multipart"},"computed":false,"property":{"type":"Identifier","name":"uploadPartBytes"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"opts"}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"type"}},"right":{"type":"StringLiteral","value":"uploader"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"id"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"||","right":{"type":"StringLiteral","value":"AwsS3Multipart"}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"RequestClient"},"arguments":[{"type":"Identifier","name":"uppy"},{"type":"TSAsExpression","expression":{"type":"Identifier","name":"opts"},"typeAnnotation":{"type":"TSAnyKeyword"}}]}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"dynamicDefaultOptions"},"init":{"type":"TSSatisfiesExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"createMultipartUpload"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"listParts"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"abortMultipartUpload"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"completeMultipartUpload"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"shorthand":false,"value":{"type":"ConditionalExpression","test":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"optional":true},"consequent":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"createSignedURL"}},"alternate":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"signPart"}}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"shorthand":false,"value":{"type":"ConditionalExpression","test":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"getTemporarySecurityCredentials"},"optional":true},"consequent":{"type":"TSAsExpression","expression":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"createSignedURL"}},"typeAnnotation":{"type":"TSAnyKeyword"}},"alternate":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"getUploadParameters"}}}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}}}}],"kind":"const"},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"key"},"init":null}],"kind":"const"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"keys"}},"arguments":[{"type":"Identifier","name":"dynamicDefaultOptions"}]},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":true,"property":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"key"},"typeAnnotation":{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"dynamicDefaultOptions"}}}}},"operator":"==","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":true,"property":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"key"},"typeAnnotation":{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"dynamicDefaultOptions"}}}}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"dynamicDefaultOptions"},"computed":true,"property":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"key"},"typeAnnotation":{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"dynamicDefaultOptions"}}}}},"computed":false,"property":{"type":"Identifier","name":"bind"}},"arguments":[{"type":"ThisExpression"}]}}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"rateLimitedQueue"}},"operator":"??","right":{"type":"NewExpression","callee":{"type":"Identifier","name":"RateLimitedQueue"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"limit"}}]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"companionCommunicationQueue"}}},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"HTTPCommunicationQueue"},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setS3MultipartState"}}},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getFile"}}}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderSockets"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}}],"directives":[]}},{"type":"ClassMethod","accessibility":"private","static":false,"computed":true,"key":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Symbol"},"computed":false,"property":{"type":"Identifier","name":"for"}},"arguments":[{"type":"StringLiteral","value":"uppy test: getClient"}]},"kind":"method","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"setOptions"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"newOptions","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3MultipartOptions"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"companionCommunicationQueue"}}},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"Identifier","name":"newOptions"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Super"},"computed":false,"property":{"type":"Identifier","name":"setOptions"}},"arguments":[{"type":"Identifier","name":"newOptions"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setCompanionHeaders"}}},"arguments":[]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"resetUploaderReferences"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"fileID","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"Identifier","name":"opts","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"abort"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}]}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}}},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"really"},"computed":false,"shorthand":false,"value":{"type":"LogicalExpression","left":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"abort"},"optional":true},"operator":"||","right":{"type":"BooleanLiteral","value":false}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}}},"computed":false,"property":{"type":"Identifier","name":"remove"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderSockets"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderSockets"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"computed":false,"property":{"type":"Identifier","name":"close"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderSockets"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"assertHost"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"method","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"companionUrl"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"method"}],"quasis":[{"type":"TemplateElement","value":{"raw":"Expected a \\`companionUrl\\` option containing a Companion address, or if you are not using Companion, a custom \\`","cooked":"Expected a `companionUrl` option containing a Companion address, or if you are not using Companion, a custom `"},"tail":false},{"type":"TemplateElement","value":{"raw":"\\` implementation.","cooked":"` implementation."},"tail":true}]}]}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"createMultipartUpload"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"signal","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"createMultipartUpload"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"allowedMetaFields"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetaFields"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"metadata"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetadata"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"meta"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"allowedMetaFields"}}]}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"post"}},"arguments":[{"type":"StringLiteral","value":"s3/multipart"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"filename"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"name"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"type"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"metadata"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"metadata"}}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"listParts"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResultWithSignal"}}}},{"type":"Identifier","name":"oldSignal","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Part"}}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"??=","left":{"type":"Identifier","name":"signal"},"right":{"type":"Identifier","name":"oldSignal"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"listParts"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filename"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"key"}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"get"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"uploadId"},{"type":"Identifier","name":"filename"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/multipart/","cooked":"s3/multipart/"},"tail":false},{"type":"TemplateElement","value":{"raw":"?key=","cooked":"?key="},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3Part"}}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"completeMultipartUpload"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"parts"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"parts"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartUploadResultWithSignal"}}}},{"type":"Identifier","name":"oldSignal","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"??=","left":{"type":"Identifier","name":"signal"},"right":{"type":"Identifier","name":"oldSignal"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"completeMultipartUpload"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filename"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"key"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadIdEnc"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"uploadId"}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"post"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"uploadIdEnc"},{"type":"Identifier","name":"filename"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/multipart/","cooked":"s3/multipart/"},"tail":false},{"type":"TemplateElement","value":{"raw":"/complete?key=","cooked":"/complete?key="},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"parts"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"parts"}}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}},"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MaybePromise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3STSResponse"}}]}}},"value":null},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"getTemporarySecurityCredentials"}},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"options","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestOptions"}}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"options"},"computed":false,"property":{"type":"Identifier","name":"signal"},"optional":true}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"operator":"==","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"getTemporarySecurityCredentials"}},"operator":"===","right":{"type":"BooleanLiteral","value":true}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"getTemporarySecurityCredentials"}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"get"}},"arguments":[{"type":"StringLiteral","value":"s3/sts"},{"type":"Identifier","name":"options"}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3STSResponse"}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"getTemporarySecurityCredentials"}},"arguments":[{"type":"Identifier","name":"options"}]}}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"right":{"type":"AwaitExpression","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}}}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"setTimeout"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"right":{"type":"TSAsExpression","expression":{"type":"NullLiteral"},"typeAnnotation":{"type":"TSAnyKeyword"}}}}],"directives":[]}},{"type":"BinaryExpression","left":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"Identifier","name":"getExpiry"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}},"computed":false,"property":{"type":"Identifier","name":"credentials"}}]},"operator":"||","right":{"type":"NumericLiteral","value":0}},"operator":"*","right":{"type":"NumericLiteral","value":500}}]}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"cachedTemporaryCredentials"}}}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"createSignedURL"},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"SignPartOptions"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"data"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getTemporarySecurityCredentials"}}},"arguments":[{"type":"Identifier","name":"options"}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"expires"},"init":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"Identifier","name":"getExpiry"},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"credentials"}}]},"operator":"||","right":{"type":"NumericLiteral","value":604800}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"partNumber"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"partNumber"}}]},"init":{"type":"Identifier","name":"options"}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"method"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"PUT"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"expires"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"expires"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"fields"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"url"},"computed":false,"shorthand":false,"value":{"type":"TemplateLiteral","expressions":[{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"createSignedURL"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"accountKey"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"credentials"}},"computed":false,"property":{"type":"Identifier","name":"AccessKeyId"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"accountSecret"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"credentials"}},"computed":false,"property":{"type":"Identifier","name":"SecretAccessKey"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"sessionToken"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"credentials"}},"computed":false,"property":{"type":"Identifier","name":"SessionToken"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"expires"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"expires"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bucketName"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"bucket"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Region"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"data"},"computed":false,"property":{"type":"Identifier","name":"region"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"Key"},"computed":false,"shorthand":false,"value":{"type":"LogicalExpression","left":{"type":"Identifier","name":"key"},"operator":"??","right":{"type":"TemplateLiteral","expressions":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"crypto"},"computed":false,"property":{"type":"Identifier","name":"randomUUID"}},"arguments":[]},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"name"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":"-","cooked":"-"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"partNumber"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"partNumber"}}]}]}}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"headers"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"StringLiteral","value":"Content-Type"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"type"}},"typeAnnotation":{"type":"TSStringKeyword"}}}]}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"signPart"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"partNumber"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"partNumber"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"SignPartOptions"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"signPart"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"Identifier","name":"uploadId"},"operator":"==","right":{"type":"NullLiteral"}},"operator":"||","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"key"},"operator":"==","right":{"type":"NullLiteral"}}},"operator":"||","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"partNumber"},"operator":"==","right":{"type":"NullLiteral"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Cannot sign without a key, an uploadId, and a partNumber"}]}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filename"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"key"}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"get"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"uploadId"},{"type":"Identifier","name":"partNumber"},{"type":"Identifier","name":"filename"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/multipart/","cooked":"s3/multipart/"},"tail":false},{"type":"TemplateElement","value":{"raw":"/","cooked":"/"},"tail":false},{"type":"TemplateElement","value":{"raw":"?key=","cooked":"?key="},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"abortMultipartUpload"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"key"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"uploadId"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResultWithSignal"}}}},{"type":"Identifier","name":"oldSignal","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"??=","left":{"type":"Identifier","name":"signal"},"right":{"type":"Identifier","name":"oldSignal"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"assertHost"}},"arguments":[{"type":"StringLiteral","value":"abortMultipartUpload"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filename"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"key"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadIdEnc"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"encodeURIComponent"},"arguments":[{"type":"Identifier","name":"uploadId"}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"delete"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"uploadIdEnc"},{"type":"Identifier","name":"filename"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/multipart/","cooked":"s3/multipart/"},"tail":false},{"type":"TemplateElement","value":{"raw":"?key=","cooked":"?key="},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"Identifier","name":"undefined"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}]}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]}},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"Identifier","name":"assertServerError"}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"getUploadParameters"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestOptions"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"meta"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"meta"}}]},"init":{"type":"Identifier","name":"file"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"type"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"name"},"computed":false,"method":false,"shorthand":false,"value":{"type":"Identifier","name":"filename"}}]},"init":{"type":"Identifier","name":"meta"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"allowedMetaFields"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetaFields"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"metadata"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetadata"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"meta"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"meta"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"querify"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"query"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"URLSearchParams"},"arguments":[{"type":"TSAsExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"filename"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"filename"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"metadata"}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}]}}],"kind":"const"},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"get"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"query"}],"quasis":[{"type":"TemplateElement","value":{"raw":"s3/params?","cooked":"s3/params?"},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]},{"type":"Identifier","name":"options"}]}}],"directives":[]}},{"type":"ClassMethod","static":true,"key":{"type":"Identifier","name":"uploadPartBytes"},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"signature"},"computed":false,"method":false,"shorthand":false,"value":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"url"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"url"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"expires"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"expires"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"headers"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"headers"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"method"},"computed":false,"method":false,"shorthand":true,"value":{"type":"AssignmentPattern","left":{"type":"Identifier","name":"method"},"right":{"type":"StringLiteral","value":"PUT"}}}]}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"body"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"body"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"size"},"computed":false,"method":false,"shorthand":true,"value":{"type":"AssignmentPattern","left":{"type":"Identifier","name":"size"},"right":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"body"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}},"computed":false,"property":{"type":"Identifier","name":"size"}}}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"onProgress"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"onProgress"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"onComplete"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"onComplete"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"signal"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"signal"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signature"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AwsS3UploadParameters"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"body"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"FormData"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"size"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onProgress"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onComplete"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSAnyKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"signal"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"AbortSignal"}}}}]}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadPartBytesResult"}}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"throwIfAborted"},"arguments":[{"type":"Identifier","name":"signal"}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"url"},"operator":"==","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Cannot upload to an undefined URL"}]}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"reject"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"xhr"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"XMLHttpRequest"},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"open"}},"arguments":[{"type":"Identifier","name":"method"},{"type":"Identifier","name":"url"},{"type":"BooleanLiteral","value":true}]}},{"type":"IfStatement","test":{"type":"Identifier","name":"headers"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"keys"}},"arguments":[{"type":"Identifier","name":"headers"}]},"computed":false,"property":{"type":"Identifier","name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"key"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"setRequestHeader"}},"arguments":[{"type":"Identifier","name":"key"},{"type":"MemberExpression","object":{"type":"Identifier","name":"headers"},"computed":true,"property":{"type":"Identifier","name":"key"}}]}}],"directives":[]}}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"responseType"}},"right":{"type":"StringLiteral","value":"text"}}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"Identifier","name":"expires"}},"operator":"===","right":{"type":"StringLiteral","value":"number"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"timeout"}},"right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"expires"},"operator":"*","right":{"type":"NumericLiteral","value":1000}}}}],"directives":[]},"alternate":null},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"onabort"},"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"cleanup"},"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"signal"},"computed":false,"property":{"type":"Identifier","name":"removeEventListener"},"optional":true},"optional":false,"arguments":[{"type":"StringLiteral","value":"abort"},{"type":"Identifier","name":"onabort"}]}}],"directives":[]}},{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"signal"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"},"optional":true},"optional":false,"arguments":[{"type":"StringLiteral","value":"abort"},{"type":"Identifier","name":"onabort"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"upload"}},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"progress"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"ev"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"onProgress"},"arguments":[{"type":"Identifier","name":"ev"}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"abort"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"cleanup"},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"CallExpression","callee":{"type":"Identifier","name":"createAbortError"},"arguments":[]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"timeout"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"cleanup"},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Request has expired"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"error"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"source"}},"right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":403}}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"error"}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"load"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"cleanup"},"arguments":[]}},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"status"}},"operator":"===","right":{"type":"NumericLiteral","value":403}},"operator":"&&","right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"responseText"}},"computed":false,"property":{"type":"Identifier","name":"includes"}},"arguments":[{"type":"StringLiteral","value":"<Message>Request has expired</Message>"}]}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Request has expired"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"error"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"source"}},"right":{"type":"Identifier","name":"xhr"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"error"}]}},{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"status"}},"operator":"<","right":{"type":"NumericLiteral","value":200}},"operator":"||","right":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"status"}},"operator":">=","right":{"type":"NumericLiteral","value":300}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Non 2xx"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"error"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"source"}},"right":{"type":"Identifier","name":"xhr"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"error"}]}},{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"Identifier","name":"onProgress"},"optional":true,"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"loaded"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"size"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"lengthComputable"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"etag"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"getResponseHeader"}},"arguments":[{"type":"StringLiteral","value":"ETag"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"location"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"getResponseHeader"}},"arguments":[{"type":"StringLiteral","value":"Location"}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"method"},"computed":false,"property":{"type":"Identifier","name":"toUpperCase"}},"arguments":[]},"operator":"===","right":{"type":"StringLiteral","value":"POST"}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"location"},"operator":"===","right":{"type":"NullLiteral"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"console"},"computed":false,"property":{"type":"Identifier","name":"warn"}},"arguments":[{"type":"StringLiteral","value":"AwsS3/Multipart: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"etag"},"operator":"===","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."}]}]}},{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"Identifier","name":"onComplete"},"optional":true,"arguments":[{"type":"Identifier","name":"etag"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"ETag"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"etag"}},{"type":"SpreadElement","argument":{"type":"ConditionalExpression","test":{"type":"Identifier","name":"location"},"consequent":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"location"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"location"}}]},"alternate":{"type":"Identifier","name":"undefined"}}}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"error"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"ev"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"cleanup"},"arguments":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"error"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Unknown error"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"error"},"typeAnnotation":{"type":"TSAnyKeyword"}},"computed":false,"property":{"type":"Identifier","name":"source"}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"ev"},"computed":false,"property":{"type":"Identifier","name":"target"}}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"error"}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"send"}},"arguments":[{"type":"Identifier","name":"body"}]}}],"directives":[]}}]}}],"directives":[]}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"setS3MultipartState"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UploadResult"}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"cFile"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"cFile"},"operator":"==","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setFileState"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"TSAsExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"s3Multipart"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"cFile"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}},"computed":false,"property":{"type":"Identifier","name":"s3Multipart"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"key"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"key"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadId"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"uploadId"}}]}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}}}]}}],"directives":[]}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"getFile"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]},"operator":"||","right":{"type":"Identifier","name":"file"}}}],"directives":[]}}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadLocalFile"}},"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSUnionType","types":[{"type":"TSVoidKeyword"},{"type":"TSStringKeyword"}]}]},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"reject"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"onProgress"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"bytesUploaded","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"Identifier","name":"bytesTotal","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-progress"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploader"},"computed":false,"shorthand":false,"value":{"type":"ThisExpression"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bytesUploaded"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"bytesUploaded"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bytesTotal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"bytesTotal"}}]}]}}],"directives":[]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"onError"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnknownKeyword"}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TSAsExpression","expression":{"type":"Identifier","name":"err"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Error"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-error"},{"type":"Identifier","name":"file"},{"type":"TSAsExpression","expression":{"type":"Identifier","name":"err"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Error"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"err"}]}}],"directives":[]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"onSuccess"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"result","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadResp"},"init":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"body"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"result"}}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":200}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadURL"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"result"},"computed":false,"property":{"type":"Identifier","name":"location"}}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-success"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getFile"}}},"arguments":[{"type":"Identifier","name":"file"}]},{"type":"Identifier","name":"uploadResp"}]}},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"result"},"computed":false,"property":{"type":"Identifier","name":"location"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"name"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"result"},"computed":false,"property":{"type":"Identifier","name":"location"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"Download ","cooked":"Download "},"tail":false},{"type":"TemplateElement","value":{"raw":" from ","cooked":" from "},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[]}}],"directives":[]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"upload"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"MultipartUploader"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"companionComm"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"companionCommunicationQueue"}}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"log"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"RestElement","argument":{"type":"Identifier","name":"args"},"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Parameters"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Uppy"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"log"}}}]}}}}],"body":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"args"}}]}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getChunkSize"},"computed":false,"shorthand":false,"value":{"type":"ConditionalExpression","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"getChunkSize"}},"consequent":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"getChunkSize"}},"computed":false,"property":{"type":"Identifier","name":"bind"}},"arguments":[{"type":"ThisExpression"}]},"alternate":{"type":"NullLiteral"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onProgress"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"onProgress"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onError"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"onError"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onSuccess"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"onSuccess"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onPartComplete"},"computed":false,"shorthand":false,"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"part"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"s3-multipart:part-uploaded"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getFile"}}},"arguments":[{"type":"Identifier","name":"file"}]},{"type":"Identifier","name":"part"}]}}],"directives":[]}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"file"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"file"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldUseMultipart"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"shouldUseMultipart"}}},{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"file"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"MultipartFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}},"computed":false,"property":{"type":"Identifier","name":"s3Multipart"}}}]}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"right":{"type":"Identifier","name":"upload"}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"eventManager"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"EventManager"},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"right":{"type":"Identifier","name":"eventManager"}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onFileRemove"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"removed"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abort"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"removed"}],"quasis":[{"type":"TemplateElement","value":{"raw":"upload ","cooked":"upload "},"tail":false},{"type":"TemplateElement","value":{"raw":" was removed","cooked":" was removed"},"tail":true}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onCancelAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"options"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"options"},"computed":false,"property":{"type":"Identifier","name":"reason"},"optional":true},"operator":"===","right":{"type":"StringLiteral","value":"user"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abort"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"upload ","cooked":"upload "},"tail":false},{"type":"TemplateElement","value":{"raw":" was canceled","cooked":" was canceled"},"tail":true}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onFilePause"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"isPaused"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"Identifier","name":"isPaused"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"pause"}},"arguments":[]}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"start"}},"arguments":[]}}],"directives":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onPauseAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"pause"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onResumeAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"start"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"start"}},"arguments":[]}}],"directives":[]}}]}}],"directives":[]}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"getCompanionClientArgs"}},"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"remote"}},"computed":false,"property":{"type":"Identifier","name":"body"},"optional":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"protocol"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"s3-multipart"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"size"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"size"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"metadata"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}}]}}],"directives":[]}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"upload"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"fileIDs","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileIDs"},"computed":false,"property":{"type":"Identifier","name":"length"}},"operator":"===","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"ReturnStatement","argument":{"type":"Identifier","name":"undefined"}},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"files"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFilesByIds"}},"arguments":[{"type":"Identifier","name":"fileIDs"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesFiltered"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"filterNonFailedFiles"},"arguments":[{"type":"Identifier","name":"files"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesToEmit"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"},"arguments":[{"type":"Identifier","name":"filesFiltered"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-start"},{"type":"Identifier","name":"filesToEmit"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"promises"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"filesFiltered"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isRemote"}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"getQueue"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}}},"arguments":[{"type":"BooleanLiteral","value":false}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"controller"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"AbortController"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"removedHandler"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"removedFile","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"removedFile"},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"===","right":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"controller"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},"alternate":null}],"directives":[]}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"file-removed"},{"type":"Identifier","name":"removedHandler"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadPromise"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getRequestClientForFile"}},"arguments":[{"type":"Identifier","name":"file"}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestClient"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},"computed":false,"property":{"type":"Identifier","name":"uploadRemoteFile"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getCompanionClientArgs"}}},"arguments":[{"type":"Identifier","name":"file"}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"controller"},"computed":false,"property":{"type":"Identifier","name":"signal"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getQueue"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"getQueue"}}]}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"wrapSyncFunction"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"off"}},"arguments":[{"type":"StringLiteral","value":"file-removed"},{"type":"Identifier","name":"removedHandler"}]}}],"directives":[]}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"priority"},"computed":false,"shorthand":false,"value":{"type":"UnaryExpression","operator":"-","prefix":true,"argument":{"type":"NumericLiteral","value":1}}}]}]},"arguments":[]}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"uploadPromise"}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadLocalFile"}}},"arguments":[{"type":"Identifier","name":"file"}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"upload"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"all"}},"arguments":[{"type":"Identifier","name":"promises"}]}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"upload"}}],"directives":[]}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"setCompanionHeaders"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"client"}}},"computed":false,"property":{"type":"Identifier","name":"setCompanionHeaders"}},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"companionHeaders"}}]}}],"directives":[]}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"boolean","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"capabilities"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"capabilities"}}]},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getState"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setState"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"capabilities"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"capabilities"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"resumableUploads"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"boolean"}}]}}]}]}}],"directives":[]}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"resetResumableCapability"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}}},"arguments":[{"type":"BooleanLiteral","value":true}]}}],"directives":[]}}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"install"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setResumableUploadsCapability"}}},"arguments":[{"type":"BooleanLiteral","value":true}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"addPreProcessor"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setCompanionHeaders"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"addUploader"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"upload"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"cancel-all"},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"resetResumableCapability"}}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"uninstall"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"removePreProcessor"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"setCompanionHeaders"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"removeUploader"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"upload"}}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"off"}},"arguments":[{"type":"StringLiteral","value":"cancel-all"},{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"resetResumableCapability"}}}]}}],"directives":[]}}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"uploadPartBytes"},"typeAnnotation":{"type":"TSIndexedAccessType","objectType":{"type":"TSParenthesizedType","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"AwsS3Multipart"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"uploadPartBytes"}}}}}],"directives":[]}}}},"renamedFiles":{"mappings":[],"before":{},"after":{}}}