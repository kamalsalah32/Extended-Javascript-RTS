{"addedFiles":{},"deletedFiles":{},"modifiedFiles":{"before":{"packages/@uppy/tus/src/index.ts":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"module","interpreter":null,"body":[{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"BasePlugin"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"DefinePluginOpts"},"local":{"type":"Identifier","name":"DefinePluginOpts"},"importKind":"type"},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"PluginOpts"},"local":{"type":"Identifier","name":"PluginOpts"},"importKind":"type"}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/BasePlugin.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportNamespaceSpecifier","local":{"type":"Identifier","name":"tus"}}],"source":{"type":"StringLiteral","value":"tus-js-client"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"EventManager"}}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/EventManager.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"NetworkError"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/NetworkError"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"isNetworkError"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/isNetworkError"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RateLimitedQueue"},"importKind":"value","local":{"type":"Identifier","name":"RateLimitedQueue"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/RateLimitedQueue"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"hasProperty"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/hasProperty"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"filterNonFailedFiles"},"importKind":"value","local":{"type":"Identifier","name":"filterNonFailedFiles"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"},"importKind":"value","local":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/fileFilters"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Meta"},"importKind":"value","local":{"type":"Identifier","name":"Meta"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"Body"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UppyFile"},"importKind":"value","local":{"type":"Identifier","name":"UppyFile"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/UppyFile"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Uppy"},"importKind":"value","local":{"type":"Identifier","name":"Uppy"}}],"source":{"type":"StringLiteral","value":"@uppy/core"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RequestClient"},"importKind":"value","local":{"type":"Identifier","name":"RequestClient"}}],"source":{"type":"StringLiteral","value":"@uppy/companion-client"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"getAllowedMetaFields"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/getAllowedMetaFields"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"getFingerprint"}}],"source":{"type":"StringLiteral","value":"./getFingerprint.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"packageJson"}}],"source":{"type":"StringLiteral","value":"../package.json"}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"RestTusUploadOptions"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Omit"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"UploadOptions"}}},{"type":"TSUnionType","types":[{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"onShouldRetry"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"onBeforeRequest"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"headers"}}]}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"TusDetailedError"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"TusBody"},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"xhr"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"XMLHttpRequest"}}}}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"extends":[{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"PluginOpts"}},{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"RestTusUploadOptions"}}],"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"endpoint"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"headers"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}},{"type":"TSParenthesizedType","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"limit"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"chunkSize"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onBeforeRequest"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"req","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"HttpRequest"}}}}},{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onShouldRetry"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"err","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}},{"type":"Identifier","name":"retryAttempt","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"next","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"e","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"retryDelays"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSNumberKeyword"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"withCredentials"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSBooleanKeyword"},{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"rateLimitedQueue"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RateLimitedQueue"}}}}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[{"type":"ExportSpecifier","local":{"type":"Identifier","name":"TusOpts"},"exportKind":"value","exported":{"type":"Identifier","name":"TusOptions"}}],"source":null,"declaration":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"tusDefaultOptions"},"init":{"type":"TSSatisfiesExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"endpoint"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":""}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadUrl"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"metadata"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadSize"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onProgress"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onChunkComplete"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onSuccess"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onError"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"overridePatchMethod"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"headers"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"addRequestId"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"chunkSize"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"Infinity"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":100},{"type":"NumericLiteral","value":1000},{"type":"NumericLiteral","value":3000},{"type":"NumericLiteral","value":5000}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"parallelUploads"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":1}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"removeFingerprintOnSuccess"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadLengthDeferred"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadDataDuringCreation"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"UploadOptions"}}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"defaultOptions"},"init":{"type":"TSSatisfiesExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":20}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"tusDefaultOptions"},"computed":false,"property":{"type":"Identifier","name":"retryDelays"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"withCredentials"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}]}}}}],"kind":"const"},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"Opts"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"DefinePluginOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"defaultOptions"}}}]}}},{"type":"TSModuleDeclaration","id":{"type":"StringLiteral","value":"@uppy/utils/lib/UppyFile"},"body":{"type":"TSModuleBlock","body":[{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"tus"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}]}}}]},"declare":true},{"type":"ExportDefaultDeclaration","exportKind":"value","declaration":{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Tus"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"superClass":{"type":"Identifier","name":"BasePlugin"},"superTypeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Opts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]},"body":{"type":"ClassBody","body":[{"type":"ClassProperty","static":true,"key":{"type":"Identifier","name":"VERSION"},"computed":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"packageJson"},"computed":false,"property":{"type":"Identifier","name":"version"}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"retryDelayIterator"}},"value":null},{"type":"ClassProperty","static":false,"key":{"type":"Identifier","name":"requests"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RateLimitedQueue"}}},"value":null},{"type":"ClassProperty","static":false,"key":{"type":"Identifier","name":"uploaders"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"Upload"}}},{"type":"TSNullKeyword"}]}]}}},"value":null},{"type":"ClassProperty","static":false,"key":{"type":"Identifier","name":"uploaderEvents"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"EventManager"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSNullKeyword"}]}]}}},"value":null},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"constructor"},"computed":false,"kind":"constructor","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uppy","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Uppy"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Super"},"arguments":[{"type":"Identifier","name":"uppy"},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"defaultOptions"}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"opts"}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"type"}},"right":{"type":"StringLiteral","value":"uploader"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"id"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"||","right":{"type":"StringLiteral","value":"Tus"}}}},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"allowedMetaFields"},"optional":true},"operator":"===","right":{"type":"Identifier","name":"undefined"}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"StringLiteral","value":"metaFields"},"operator":"in","right":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"The `metaFields` option has been renamed to `allowedMetaFields`."}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"StringLiteral","value":"autoRetry"},"operator":"in","right":{"type":"Identifier","name":"opts"}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"The `autoRetry` option was deprecated and has been removed."}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"rateLimitedQueue"}},"operator":"??","right":{"type":"NewExpression","callee":{"type":"Identifier","name":"RateLimitedQueue"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"limit"}}]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"retryDelayIterator"}}},"right":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"retryDelays"}},"computed":false,"property":{"type":"Identifier","name":"values"},"optional":true},"optional":false,"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"resetUploaderReferences"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"fileID","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"Identifier","name":"opts","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"abort"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}]}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploader"},"init":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"Identifier","name":"uploader"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploader"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"IfStatement","test":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"abort"},"optional":true},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploader"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[{"type":"BooleanLiteral","value":true}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}}},"computed":false,"property":{"type":"Identifier","name":"remove"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadLocalFile"}},"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"Upload"}}},{"type":"TSStringKeyword"}]}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"Upload"}}},{"type":"TSStringKeyword"}]}]},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"reject"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"queuedRequest","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"ReturnType"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RateLimitedQueue"}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"run"}}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"qRequest","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"upload","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"Upload"}}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"opts"},"init":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}}},{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"tus"}},"operator":"||","right":{"type":"ObjectExpression","properties":[]}}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}},"arguments":[{"type":"Identifier","name":"file"}]}}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"onShouldRetry"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"onShouldRetry"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"onBeforeRequest"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"onBeforeRequest"}},{"type":"RestElement","argument":{"type":"Identifier","name":"commonOpts"}}]},"init":{"type":"Identifier","name":"opts"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadOptions","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"UploadOptions"}}}}},"init":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"tusDefaultOptions"}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"commonOpts"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"fingerprint"}},"right":{"type":"CallExpression","callee":{"type":"Identifier","name":"getFingerprint"},"arguments":[{"type":"Identifier","name":"file"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onBeforeRequest"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"req"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"xhr"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"req"},"computed":false,"property":{"type":"Identifier","name":"getUnderlyingObject"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"withCredentials"}},"right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"withCredentials"}}}}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userProvidedPromise"},"init":null}],"kind":"let"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"Identifier","name":"onBeforeRequest"}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"userProvidedPromise"},"right":{"type":"CallExpression","callee":{"type":"Identifier","name":"onBeforeRequest"},"arguments":[{"type":"Identifier","name":"req"},{"type":"Identifier","name":"file"}]}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"CallExpression","callee":{"type":"Identifier","name":"hasProperty"},"arguments":[{"type":"Identifier","name":"queuedRequest"},{"type":"StringLiteral","value":"shouldBeRequeued"}]},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"shouldBeRequeued"}}},"consequent":{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"reject"}},"arguments":[]}},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"done","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"p"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"res"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"done"},"right":{"type":"Identifier","name":"res"}}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"run"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isPaused"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"done"},"arguments":[]}},{"type":"ReturnStatement","argument":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[],"directives":[]}}}],"directives":[]}}]}}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"all"}},"arguments":[{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"p"},{"type":"Identifier","name":"userProvidedPromise"}]}]}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"undefined"}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"userProvidedPromise"}}],"directives":[]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onError"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"xhr"},"init":{"type":"ConditionalExpression","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"err"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}},"computed":false,"property":{"type":"Identifier","name":"originalRequest"}},"operator":"!=","right":{"type":"NullLiteral"}},"consequent":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"err"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}},"computed":false,"property":{"type":"Identifier","name":"originalRequest"}},"computed":false,"property":{"type":"Identifier","name":"getUnderlyingObject"}},"arguments":[]},"alternate":{"type":"NullLiteral"}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"CallExpression","callee":{"type":"Identifier","name":"isNetworkError"},"arguments":[{"type":"Identifier","name":"xhr"}]},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"err"},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"NetworkError"},"arguments":[{"type":"Identifier","name":"err"},{"type":"Identifier","name":"xhr"}]}}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"},"optional":true},"optional":false,"arguments":[]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onError"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onError"}},"arguments":[{"type":"Identifier","name":"err"}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"err"}]}}],"directives":[]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onProgress"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"bytesUploaded"},{"type":"Identifier","name":"bytesTotal"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"onReceiveUploadUrl"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onProgress"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onProgress"}},"arguments":[{"type":"Identifier","name":"bytesUploaded"},{"type":"Identifier","name":"bytesTotal"}]}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"latestFile"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-progress"},{"type":"Identifier","name":"latestFile"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadStarted"},"computed":false,"shorthand":false,"value":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"latestFile"},"computed":false,"property":{"type":"Identifier","name":"progress"}},"computed":false,"property":{"type":"Identifier","name":"uploadStarted"}},"operator":"??","right":{"type":"NumericLiteral","value":0}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bytesUploaded"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"bytesUploaded"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bytesTotal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"bytesTotal"}}]}]}}],"directives":[]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onSuccess"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"payload"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadResp","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"response"}}}}},"init":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadURL"},"computed":false,"shorthand":false,"value":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}},"operator":"??","right":{"type":"Identifier","name":"undefined"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":200}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"body"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"TSAsExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"xhr"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"payload"},"computed":false,"property":{"type":"Identifier","name":"lastResponse"}},"computed":false,"property":{"type":"Identifier","name":"getUnderlyingObject"}},"arguments":[]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"XMLHttpRequest"}}}}]},"typeAnnotation":{"type":"TSUnknownKeyword"}},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"done"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-success"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]},{"type":"Identifier","name":"uploadResp"}]}},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"name"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"name"}}]},"init":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"file"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"name"},{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"Download ","cooked":"Download "},"tail":false},{"type":"TemplateElement","value":{"raw":" from ","cooked":" from "},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onSuccess"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onSuccess"}},"arguments":[{"type":"Identifier","name":"payload"}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"Identifier","name":"upload"}]}}],"directives":[]}}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"defaultOnShouldRetry"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"status"},"init":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"err"},"computed":false,"property":{"type":"Identifier","name":"originalResponse"},"optional":true},"computed":false,"property":{"type":"Identifier","name":"getStatus"},"optional":true},"optional":false,"arguments":[]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"===","right":{"type":"NumericLiteral","value":429}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"isPaused"}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"next"},"init":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"retryDelayIterator"}}},"computed":false,"property":{"type":"Identifier","name":"next"},"optional":true},"optional":false,"arguments":[]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"Identifier","name":"next"},"operator":"==","right":{"type":"NullLiteral"}},"operator":"||","right":{"type":"MemberExpression","object":{"type":"Identifier","name":"next"},"computed":false,"property":{"type":"Identifier","name":"done"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"BooleanLiteral","value":false}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"rateLimit"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"next"},"computed":false,"property":{"type":"Identifier","name":"value"}}]}}],"directives":[]},"alternate":null}],"directives":[]},"alternate":{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"LogicalExpression","left":{"type":"LogicalExpression","left":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"!=","right":{"type":"NullLiteral"}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":">=","right":{"type":"NumericLiteral","value":400}}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"<","right":{"type":"NumericLiteral","value":500}}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"!==","right":{"type":"NumericLiteral","value":409}}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"!==","right":{"type":"NumericLiteral","value":423}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"BooleanLiteral","value":false}}],"directives":[]},"alternate":{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"Identifier","name":"navigator"}},"operator":"!==","right":{"type":"StringLiteral","value":"undefined"}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"navigator"},"computed":false,"property":{"type":"Identifier","name":"onLine"}},"operator":"===","right":{"type":"BooleanLiteral","value":false}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"isPaused"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"pause"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"window"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"online"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"resume"}},"arguments":[]}}],"directives":[]}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"once"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}}],"directives":[]},"alternate":null}],"directives":[]},"alternate":null}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldBeRequeued"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectMethod","method":true,"key":{"type":"Identifier","name":"abort"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"shouldBeRequeued"}},"right":{"type":"BooleanLiteral","value":false}}}],"directives":[]}},{"type":"ObjectMethod","method":true,"key":{"type":"Identifier","name":"done"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Cannot mark a queued request as done: this indicates a bug"}]}}],"directives":[]}},{"type":"ObjectMethod","method":true,"key":{"type":"Identifier","name":"fn"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Cannot run a queued request: this indicates a bug"}]}}],"directives":[]}}]}}},{"type":"ReturnStatement","argument":{"type":"BooleanLiteral","value":true}}],"directives":[]}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"onShouldRetry"},"operator":"!=","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onShouldRetry"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"error","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}},{"type":"Identifier","name":"retryAttempt","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}}],"body":{"type":"CallExpression","callee":{"type":"Identifier","name":"onShouldRetry"},"arguments":[{"type":"Identifier","name":"error"},{"type":"Identifier","name":"retryAttempt"},{"type":"Identifier","name":"opts"},{"type":"Identifier","name":"defaultOnShouldRetry"}]}}}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onShouldRetry"}},"right":{"type":"Identifier","name":"defaultOnShouldRetry"}}}],"directives":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"copyProp"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"obj","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnknownKeyword"}]}}}},{"type":"Identifier","name":"srcProp","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"Identifier","name":"destProp","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"Identifier","name":"hasProperty"},"arguments":[{"type":"Identifier","name":"obj"},{"type":"Identifier","name":"srcProp"}]},"operator":"&&","right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"hasProperty"},"arguments":[{"type":"Identifier","name":"obj"},{"type":"Identifier","name":"destProp"}]}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"obj"},"computed":true,"property":{"type":"Identifier","name":"destProp"}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"obj"},"computed":true,"property":{"type":"Identifier","name":"srcProp"}}}}],"directives":[]},"alternate":null}],"directives":[]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"meta","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}},"init":{"type":"ObjectExpression","properties":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"allowedMetaFields"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetaFields"},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"property":{"type":"Identifier","name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"item"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"meta"},"computed":true,"property":{"type":"Identifier","name":"item"}},"right":{"type":"CallExpression","callee":{"type":"Identifier","name":"String"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":true,"property":{"type":"Identifier","name":"item"}}]}}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"copyProp"},"arguments":[{"type":"Identifier","name":"meta"},{"type":"StringLiteral","value":"type"},{"type":"StringLiteral","value":"filetype"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"copyProp"},"arguments":[{"type":"Identifier","name":"meta"},{"type":"StringLiteral","value":"name"},{"type":"StringLiteral","value":"filename"}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"metadata"}},"right":{"type":"Identifier","name":"meta"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"upload"},"right":{"type":"NewExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tus"},"computed":false,"property":{"type":"Identifier","name":"Upload"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},{"type":"Identifier","name":"uploadOptions"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"right":{"type":"Identifier","name":"upload"}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"eventManager"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"EventManager"},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"right":{"type":"Identifier","name":"eventManager"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"qRequest"},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isPaused"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"start"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[],"directives":[]}}}],"directives":[]}}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"findPreviousUploads"}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"previousUploads"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"previousUpload"},"init":{"type":"MemberExpression","object":{"type":"Identifier","name":"previousUploads"},"computed":true,"property":{"type":"NumericLiteral","value":0}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"Identifier","name":"previousUpload"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"previousUpload"},"computed":false,"property":{"type":"Identifier","name":"creationTime"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"[Tus] Resuming upload of ","cooked":"[Tus] Resuming upload of "},"tail":false},{"type":"TemplateElement","value":{"raw":" started at ","cooked":" started at "},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"resumeFromPreviousUpload"}},"arguments":[{"type":"Identifier","name":"previousUpload"}]}}],"directives":[]},"alternate":null}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"run"}},"arguments":[{"type":"Identifier","name":"qRequest"}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onFileRemove"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"targetFileID"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abort"},"computed":false,"shorthand":false,"value":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}}}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"targetFileID"}],"quasis":[{"type":"TemplateElement","value":{"raw":"upload ","cooked":"upload "},"tail":false},{"type":"TemplateElement","value":{"raw":" was removed","cooked":" was removed"},"tail":true}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onPause"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"isPaused"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"IfStatement","test":{"type":"Identifier","name":"isPaused"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"run"}},"arguments":[{"type":"Identifier","name":"qRequest"}]}}}],"directives":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onPauseAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onCancelAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abort"},"computed":false,"shorthand":false,"value":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}}}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"upload ","cooked":"upload "},"tail":false},{"type":"TemplateElement","value":{"raw":" was canceled","cooked":" was canceled"},"tail":true}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onResumeAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"error"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"run"}},"arguments":[{"type":"Identifier","name":"qRequest"}]}}}],"directives":[]}}]}}],"directives":[]}}]},"computed":false,"property":{"type":"Identifier","name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-error"},{"type":"Identifier","name":"file"},{"type":"Identifier","name":"err"}]}},{"type":"ThrowStatement","argument":{"type":"Identifier","name":"err"}}],"directives":[]}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"onReceiveUploadUrl"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"uploadURL","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSStringKeyword"},{"type":"TSNullKeyword"}]}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"currentFile"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"currentFile"}},"consequent":{"type":"ReturnStatement","argument":null},"alternate":null},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"currentFile"},"computed":false,"property":{"type":"Identifier","name":"tus"}}},"operator":"||","right":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"currentFile"},"computed":false,"property":{"type":"Identifier","name":"tus"}},"computed":false,"property":{"type":"Identifier","name":"uploadUrl"}},"operator":"!==","right":{"type":"Identifier","name":"uploadURL"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"[Tus] Storing upload url"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setFileState"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"currentFile"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"tus"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"currentFile"},"computed":false,"property":{"type":"Identifier","name":"tus"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadUrl"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"uploadURL"}}]}}]}]}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"getCompanionClientArgs"}},"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"opts"},"init":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"tus"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"assign"}},"arguments":[{"type":"Identifier","name":"opts"},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"tus"}}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}},"arguments":[{"type":"Identifier","name":"file"}]}}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"remote"}},"computed":false,"property":{"type":"Identifier","name":"body"},"optional":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"endpoint"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"endpoint"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadUrl"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"uploadUrl"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"protocol"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"tus"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"size"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"size"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"headers"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"metadata"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}}]}}],"directives":[]}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadFiles"}},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"files","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesFiltered"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"filterNonFailedFiles"},"arguments":[{"type":"Identifier","name":"files"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesToEmit"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"},"arguments":[{"type":"Identifier","name":"filesFiltered"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-start"},{"type":"Identifier","name":"filesToEmit"}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"allSettled"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"filesFiltered"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isRemote"}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"getQueue"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"controller"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"AbortController"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"removedHandler"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"removedFile","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"removedFile"},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"===","right":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"controller"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},"alternate":null}],"directives":[]}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"file-removed"},{"type":"Identifier","name":"removedHandler"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadPromise"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getRequestClientForFile"}},"arguments":[{"type":"Identifier","name":"file"}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestClient"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},"computed":false,"property":{"type":"Identifier","name":"uploadRemoteFile"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getCompanionClientArgs"}}},"arguments":[{"type":"Identifier","name":"file"}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"controller"},"computed":false,"property":{"type":"Identifier","name":"signal"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getQueue"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"getQueue"}}]}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"wrapSyncFunction"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"off"}},"arguments":[{"type":"StringLiteral","value":"file-removed"},{"type":"Identifier","name":"removedHandler"}]}}],"directives":[]}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"priority"},"computed":false,"shorthand":false,"value":{"type":"UnaryExpression","operator":"-","prefix":true,"argument":{"type":"NumericLiteral","value":1}}}]}]},"arguments":[]}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"uploadPromise"}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadLocalFile"}}},"arguments":[{"type":"Identifier","name":"file"}]}}],"directives":[]}}]}]}}}],"directives":[]}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"handleUpload"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"fileIDs","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileIDs"},"computed":false,"property":{"type":"Identifier","name":"length"}},"operator":"===","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"[Tus] No files to upload"}]}},{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"limit"}},"operator":"===","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0"},{"type":"StringLiteral","value":"warning"}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"[Tus] Uploading..."}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesToUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFilesByIds"}},"arguments":[{"type":"Identifier","name":"fileIDs"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadFiles"}}},"arguments":[{"type":"Identifier","name":"filesToUpload"}]}}}],"directives":[]}}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"install"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setState"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"capabilities"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getState"}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"capabilities"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"resumableUploads"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"addUploader"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"handleUpload"}}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"uninstall"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setState"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"capabilities"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getState"}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"capabilities"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"resumableUploads"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"removeUploader"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"handleUpload"}}}]}}],"directives":[]}}]}}}],"directives":[]}}},"after":{"packages/@uppy/tus/src/index.ts":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"module","interpreter":null,"body":[{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"BasePlugin"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"DefinePluginOpts"},"local":{"type":"Identifier","name":"DefinePluginOpts"},"importKind":"type"},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"PluginOpts"},"local":{"type":"Identifier","name":"PluginOpts"},"importKind":"type"}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/BasePlugin.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportNamespaceSpecifier","local":{"type":"Identifier","name":"tus"}}],"source":{"type":"StringLiteral","value":"tus-js-client"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"EventManager"}}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/EventManager.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"NetworkError"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/NetworkError"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"isNetworkError"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/isNetworkError"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RateLimitedQueue"},"importKind":"value","local":{"type":"Identifier","name":"RateLimitedQueue"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/RateLimitedQueue"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"hasProperty"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/hasProperty"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"filterNonFailedFiles"},"importKind":"value","local":{"type":"Identifier","name":"filterNonFailedFiles"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"},"importKind":"value","local":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/fileFilters"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Meta"},"importKind":"value","local":{"type":"Identifier","name":"Meta"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"Body"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UppyFile"},"importKind":"value","local":{"type":"Identifier","name":"UppyFile"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/UppyFile"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Uppy"},"importKind":"value","local":{"type":"Identifier","name":"Uppy"}}],"source":{"type":"StringLiteral","value":"@uppy/core"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RequestClient"},"importKind":"value","local":{"type":"Identifier","name":"RequestClient"}}],"source":{"type":"StringLiteral","value":"@uppy/companion-client"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"getAllowedMetaFields"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/getAllowedMetaFields"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"getFingerprint"}}],"source":{"type":"StringLiteral","value":"./getFingerprint.ts"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"packageJson"}}],"source":{"type":"StringLiteral","value":"../package.json"}},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"RestTusUploadOptions"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Omit"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"UploadOptions"}}},{"type":"TSUnionType","types":[{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"onShouldRetry"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"onBeforeRequest"}},{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"headers"}}]}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"TusDetailedError"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"TusBody"},"typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"xhr"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"XMLHttpRequest"}}}}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"extends":[{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"PluginOpts"}},{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"RestTusUploadOptions"}}],"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"endpoint"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"headers"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}},{"type":"TSParenthesizedType","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"limit"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"chunkSize"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onBeforeRequest"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"req","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"HttpRequest"}}}}},{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"onShouldRetry"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"err","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}},{"type":"Identifier","name":"retryAttempt","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"Identifier","name":"options","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"next","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"e","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"retryDelays"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSNumberKeyword"}}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"withCredentials"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSBooleanKeyword"},{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}}]}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"rateLimitedQueue"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RateLimitedQueue"}}}}]}}},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[{"type":"ExportSpecifier","local":{"type":"Identifier","name":"TusOpts"},"exportKind":"value","exported":{"type":"Identifier","name":"TusOptions"}}],"source":null,"declaration":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"tusDefaultOptions"},"init":{"type":"TSSatisfiesExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"endpoint"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":""}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadUrl"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"metadata"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadSize"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onProgress"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onChunkComplete"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onSuccess"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"onError"},"computed":false,"shorthand":false,"value":{"type":"NullLiteral"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"overridePatchMethod"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"headers"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"addRequestId"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"chunkSize"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"Infinity"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"ArrayExpression","elements":[{"type":"NumericLiteral","value":100},{"type":"NumericLiteral","value":1000},{"type":"NumericLiteral","value":3000},{"type":"NumericLiteral","value":5000}]}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"parallelUploads"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":1}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"removeFingerprintOnSuccess"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadLengthDeferred"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadDataDuringCreation"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"UploadOptions"}}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"defaultOptions"},"init":{"type":"TSSatisfiesExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":20}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"retryDelays"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"tusDefaultOptions"},"computed":false,"property":{"type":"Identifier","name":"retryDelays"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"withCredentials"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSAnyKeyword"},{"type":"TSAnyKeyword"}]}}]}}}}],"kind":"const"},{"type":"TSTypeAliasDeclaration","id":{"type":"Identifier","name":"Opts"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"DefinePluginOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"defaultOptions"}}}]}}},{"type":"TSModuleDeclaration","id":{"type":"StringLiteral","value":"@uppy/utils/lib/UppyFile"},"body":{"type":"TSModuleBlock","body":[{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"tus"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}]}}}]},"declare":true},{"type":"ExportDefaultDeclaration","exportKind":"value","declaration":{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Tus"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"superClass":{"type":"Identifier","name":"BasePlugin"},"superTypeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Opts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]},"body":{"type":"ClassBody","body":[{"type":"ClassProperty","static":true,"key":{"type":"Identifier","name":"VERSION"},"computed":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"packageJson"},"computed":false,"property":{"type":"Identifier","name":"version"}}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"retryDelayIterator"}},"value":null},{"type":"ClassProperty","static":false,"key":{"type":"Identifier","name":"requests"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RateLimitedQueue"}}},"value":null},{"type":"ClassProperty","static":false,"key":{"type":"Identifier","name":"uploaders"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"Upload"}}},{"type":"TSNullKeyword"}]}]}}},"value":null},{"type":"ClassProperty","static":false,"key":{"type":"Identifier","name":"uploaderEvents"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"EventManager"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},{"type":"TSNullKeyword"}]}]}}},"value":null},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"constructor"},"computed":false,"kind":"constructor","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uppy","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Uppy"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"TusOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Super"},"arguments":[{"type":"Identifier","name":"uppy"},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"defaultOptions"}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"opts"}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"type"}},"right":{"type":"StringLiteral","value":"uploader"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"id"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"||","right":{"type":"StringLiteral","value":"Tus"}}}},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"allowedMetaFields"},"optional":true},"operator":"===","right":{"type":"Identifier","name":"undefined"}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"StringLiteral","value":"metaFields"},"operator":"in","right":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"The `metaFields` option has been renamed to `allowedMetaFields`."}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"StringLiteral","value":"autoRetry"},"operator":"in","right":{"type":"Identifier","name":"opts"}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"The `autoRetry` option was deprecated and has been removed."}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"rateLimitedQueue"}},"operator":"??","right":{"type":"NewExpression","callee":{"type":"Identifier","name":"RateLimitedQueue"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"limit"}}]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"retryDelayIterator"}}},"right":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"retryDelays"}},"computed":false,"property":{"type":"Identifier","name":"values"},"optional":true},"optional":false,"arguments":[]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"create"}},"arguments":[{"type":"NullLiteral"}]}}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"resetUploaderReferences"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"fileID","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"Identifier","name":"opts","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeLiteral","members":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"abort"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSBooleanKeyword"}}}]}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploader"},"init":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"Identifier","name":"uploader"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploader"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"IfStatement","test":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"abort"},"optional":true},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploader"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[{"type":"BooleanLiteral","value":true}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"TSNonNullExpression","expression":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}}},"computed":false,"property":{"type":"Identifier","name":"remove"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"Identifier","name":"fileID"}},"right":{"type":"NullLiteral"}}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadLocalFile"}},"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"Upload"}}},{"type":"TSStringKeyword"}]}]}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"Upload"}}},{"type":"TSStringKeyword"}]}]},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"reject"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"queuedRequest","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"ReturnType"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RateLimitedQueue"}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"run"}}}]}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"qRequest","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"upload","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"Upload"}}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"opts"},"init":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}}},{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"tus"}},"operator":"||","right":{"type":"ObjectExpression","properties":[]}}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}},"arguments":[{"type":"Identifier","name":"file"}]}}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"onShouldRetry"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"onShouldRetry"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"onBeforeRequest"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"onBeforeRequest"}},{"type":"RestElement","argument":{"type":"Identifier","name":"commonOpts"}}]},"init":{"type":"Identifier","name":"opts"}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadOptions","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"UploadOptions"}}}}},"init":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"tusDefaultOptions"}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"commonOpts"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"fingerprint"}},"right":{"type":"CallExpression","callee":{"type":"Identifier","name":"getFingerprint"},"arguments":[{"type":"Identifier","name":"file"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onBeforeRequest"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"req"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"xhr"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"req"},"computed":false,"property":{"type":"Identifier","name":"getUnderlyingObject"}},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"xhr"},"computed":false,"property":{"type":"Identifier","name":"withCredentials"}},"right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"withCredentials"}}}}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userProvidedPromise"},"init":null}],"kind":"let"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"Identifier","name":"onBeforeRequest"}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"userProvidedPromise"},"right":{"type":"CallExpression","callee":{"type":"Identifier","name":"onBeforeRequest"},"arguments":[{"type":"Identifier","name":"req"},{"type":"Identifier","name":"file"}]}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"CallExpression","callee":{"type":"Identifier","name":"hasProperty"},"arguments":[{"type":"Identifier","name":"queuedRequest"},{"type":"StringLiteral","value":"shouldBeRequeued"}]},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"shouldBeRequeued"}}},"consequent":{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"reject"}},"arguments":[]}},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"done","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}}},"init":null}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"p"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"res"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"done"},"right":{"type":"Identifier","name":"res"}}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"run"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isPaused"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"done"},"arguments":[]}},{"type":"ReturnStatement","argument":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[],"directives":[]}}}],"directives":[]}}]}}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"all"}},"arguments":[{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"p"},{"type":"Identifier","name":"userProvidedPromise"}]}]}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"undefined"}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"userProvidedPromise"}}],"directives":[]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onError"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"Identifier","name":"err"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"xhr"},"init":{"type":"ConditionalExpression","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"err"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}},"computed":false,"property":{"type":"Identifier","name":"originalRequest"}},"operator":"!=","right":{"type":"NullLiteral"}},"consequent":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"err"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}},"computed":false,"property":{"type":"Identifier","name":"originalRequest"}},"computed":false,"property":{"type":"Identifier","name":"getUnderlyingObject"}},"arguments":[]},"alternate":{"type":"NullLiteral"}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"CallExpression","callee":{"type":"Identifier","name":"isNetworkError"},"arguments":[{"type":"Identifier","name":"xhr"}]},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"err"},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"NetworkError"},"arguments":[{"type":"Identifier","name":"err"},{"type":"Identifier","name":"xhr"}]}}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"},"optional":true},"optional":false,"arguments":[]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onError"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onError"}},"arguments":[{"type":"Identifier","name":"err"}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"reject"},"arguments":[{"type":"Identifier","name":"err"}]}}],"directives":[]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onProgress"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"bytesUploaded"},{"type":"Identifier","name":"bytesTotal"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"onReceiveUploadUrl"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onProgress"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onProgress"}},"arguments":[{"type":"Identifier","name":"bytesUploaded"},{"type":"Identifier","name":"bytesTotal"}]}}],"directives":[]},"alternate":null},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"latestFile"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-progress"},{"type":"Identifier","name":"latestFile"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadStarted"},"computed":false,"shorthand":false,"value":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"latestFile"},"computed":false,"property":{"type":"Identifier","name":"progress"}},"computed":false,"property":{"type":"Identifier","name":"uploadStarted"}},"operator":"??","right":{"type":"NumericLiteral","value":0}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bytesUploaded"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"bytesUploaded"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"bytesTotal"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"bytesTotal"}}]}]}}],"directives":[]}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onSuccess"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"payload"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadResp","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSIndexedAccessType","objectType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}},"indexType":{"type":"TSLiteralType","literal":{"type":"StringLiteral","value":"response"}}}}},"init":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadURL"},"computed":false,"shorthand":false,"value":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}},"operator":"??","right":{"type":"Identifier","name":"undefined"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"status"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":200}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"body"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"TSAsExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"xhr"},"computed":false,"shorthand":false,"value":{"type":"TSAsExpression","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"payload"},"computed":false,"property":{"type":"Identifier","name":"lastResponse"}},"computed":false,"property":{"type":"Identifier","name":"getUnderlyingObject"}},"arguments":[]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"XMLHttpRequest"}}}}]},"typeAnnotation":{"type":"TSUnknownKeyword"}},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-success"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]},{"type":"Identifier","name":"uploadResp"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"done"}},"arguments":[]}},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"name"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"name"}}]},"init":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"file"}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"name"},{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"Download ","cooked":"Download "},"tail":false},{"type":"TemplateElement","value":{"raw":" from ","cooked":" from "},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onSuccess"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"onSuccess"}},"arguments":[{"type":"Identifier","name":"payload"}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"Identifier","name":"upload"}]}}],"directives":[]}}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"defaultOnShouldRetry"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"status"},"init":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"OptionalMemberExpression","object":{"type":"Identifier","name":"err"},"computed":false,"property":{"type":"Identifier","name":"originalResponse"},"optional":true},"computed":false,"property":{"type":"Identifier","name":"getStatus"},"optional":true},"optional":false,"arguments":[]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"===","right":{"type":"NumericLiteral","value":429}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"isPaused"}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"next"},"init":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"retryDelayIterator"}}},"computed":false,"property":{"type":"Identifier","name":"next"},"optional":true},"optional":false,"arguments":[]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"Identifier","name":"next"},"operator":"==","right":{"type":"NullLiteral"}},"operator":"||","right":{"type":"MemberExpression","object":{"type":"Identifier","name":"next"},"computed":false,"property":{"type":"Identifier","name":"done"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"BooleanLiteral","value":false}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"rateLimit"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"next"},"computed":false,"property":{"type":"Identifier","name":"value"}}]}}],"directives":[]},"alternate":null}],"directives":[]},"alternate":{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"LogicalExpression","left":{"type":"LogicalExpression","left":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"!=","right":{"type":"NullLiteral"}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":">=","right":{"type":"NumericLiteral","value":400}}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"<","right":{"type":"NumericLiteral","value":500}}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"!==","right":{"type":"NumericLiteral","value":409}}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"Identifier","name":"status"},"operator":"!==","right":{"type":"NumericLiteral","value":423}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"BooleanLiteral","value":false}}],"directives":[]},"alternate":{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"Identifier","name":"navigator"}},"operator":"!==","right":{"type":"StringLiteral","value":"undefined"}},"operator":"&&","right":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"navigator"},"computed":false,"property":{"type":"Identifier","name":"onLine"}},"operator":"===","right":{"type":"BooleanLiteral","value":false}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"isPaused"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"pause"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"window"},"computed":false,"property":{"type":"Identifier","name":"addEventListener"}},"arguments":[{"type":"StringLiteral","value":"online"},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"resume"}},"arguments":[]}}],"directives":[]}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"once"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}]}}],"directives":[]},"alternate":null}],"directives":[]},"alternate":null}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"shouldBeRequeued"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}},{"type":"ObjectMethod","method":true,"key":{"type":"Identifier","name":"abort"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"shouldBeRequeued"}},"right":{"type":"BooleanLiteral","value":false}}}],"directives":[]}},{"type":"ObjectMethod","method":true,"key":{"type":"Identifier","name":"done"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Cannot mark a queued request as done: this indicates a bug"}]}}],"directives":[]}},{"type":"ObjectMethod","method":true,"key":{"type":"Identifier","name":"fn"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Error"},"arguments":[{"type":"StringLiteral","value":"Cannot run a queued request: this indicates a bug"}]}}],"directives":[]}}]}}},{"type":"ReturnStatement","argument":{"type":"BooleanLiteral","value":true}}],"directives":[]}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"onShouldRetry"},"operator":"!=","right":{"type":"NullLiteral"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onShouldRetry"}},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"error","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"tus"},"right":{"type":"Identifier","name":"DetailedError"}}}}},{"type":"Identifier","name":"retryAttempt","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}}],"body":{"type":"CallExpression","callee":{"type":"Identifier","name":"onShouldRetry"},"arguments":[{"type":"Identifier","name":"error"},{"type":"Identifier","name":"retryAttempt"},{"type":"Identifier","name":"opts"},{"type":"Identifier","name":"defaultOnShouldRetry"}]}}}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"onShouldRetry"}},"right":{"type":"Identifier","name":"defaultOnShouldRetry"}}}],"directives":[]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"copyProp"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"obj","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSUnknownKeyword"}]}}}},{"type":"Identifier","name":"srcProp","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}},{"type":"Identifier","name":"destProp","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSStringKeyword"}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"CallExpression","callee":{"type":"Identifier","name":"hasProperty"},"arguments":[{"type":"Identifier","name":"obj"},{"type":"Identifier","name":"srcProp"}]},"operator":"&&","right":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"hasProperty"},"arguments":[{"type":"Identifier","name":"obj"},{"type":"Identifier","name":"destProp"}]}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"obj"},"computed":true,"property":{"type":"Identifier","name":"destProp"}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"obj"},"computed":true,"property":{"type":"Identifier","name":"srcProp"}}}}],"directives":[]},"alternate":null}],"directives":[]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"meta","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Record"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSStringKeyword"},{"type":"TSStringKeyword"}]}}}},"init":{"type":"ObjectExpression","properties":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"allowedMetaFields"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getAllowedMetaFields"},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"allowedMetaFields"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"allowedMetaFields"},"computed":false,"property":{"type":"Identifier","name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"item"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"meta"},"computed":true,"property":{"type":"Identifier","name":"item"}},"right":{"type":"CallExpression","callee":{"type":"Identifier","name":"String"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":true,"property":{"type":"Identifier","name":"item"}}]}}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"copyProp"},"arguments":[{"type":"Identifier","name":"meta"},{"type":"StringLiteral","value":"type"},{"type":"StringLiteral","value":"filetype"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"copyProp"},"arguments":[{"type":"Identifier","name":"meta"},{"type":"StringLiteral","value":"name"},{"type":"StringLiteral","value":"filename"}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploadOptions"},"computed":false,"property":{"type":"Identifier","name":"metadata"}},"right":{"type":"Identifier","name":"meta"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"upload"},"right":{"type":"NewExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tus"},"computed":false,"property":{"type":"Identifier","name":"Upload"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},{"type":"Identifier","name":"uploadOptions"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaders"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"right":{"type":"Identifier","name":"upload"}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"eventManager"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"EventManager"},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uploaderEvents"}},"computed":true,"property":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"right":{"type":"Identifier","name":"eventManager"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"qRequest"},"right":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isPaused"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"start"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[],"directives":[]}}}],"directives":[]}}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"findPreviousUploads"}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"then"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"previousUploads"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"previousUpload"},"init":{"type":"MemberExpression","object":{"type":"Identifier","name":"previousUploads"},"computed":true,"property":{"type":"NumericLiteral","value":0}}}],"kind":"const"},{"type":"IfStatement","test":{"type":"Identifier","name":"previousUpload"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"previousUpload"},"computed":false,"property":{"type":"Identifier","name":"creationTime"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"[Tus] Resuming upload of ","cooked":"[Tus] Resuming upload of "},"tail":false},{"type":"TemplateElement","value":{"raw":" started at ","cooked":" started at "},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"resumeFromPreviousUpload"}},"arguments":[{"type":"Identifier","name":"previousUpload"}]}}],"directives":[]},"alternate":null}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"run"}},"arguments":[{"type":"Identifier","name":"qRequest"}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onFileRemove"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"targetFileID"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abort"},"computed":false,"shorthand":false,"value":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}}}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"Identifier","name":"targetFileID"}],"quasis":[{"type":"TemplateElement","value":{"raw":"upload ","cooked":"upload "},"tail":false},{"type":"TemplateElement","value":{"raw":" was removed","cooked":" was removed"},"tail":true}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onPause"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"isPaused"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"IfStatement","test":{"type":"Identifier","name":"isPaused"},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"run"}},"arguments":[{"type":"Identifier","name":"qRequest"}]}}}],"directives":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onPauseAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onCancelAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"resetUploaderReferences"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"abort"},"computed":false,"shorthand":false,"value":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"url"}}}}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Identifier","name":"resolve"},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"upload ","cooked":"upload "},"tail":false},{"type":"TemplateElement","value":{"raw":" was canceled","cooked":" was canceled"},"tail":true}]}]}}],"directives":[]}}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"eventManager"},"computed":false,"property":{"type":"Identifier","name":"onResumeAll"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"queuedRequest"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"error"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"Identifier","name":"queuedRequest"},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"run"}},"arguments":[{"type":"Identifier","name":"qRequest"}]}}}],"directives":[]}}]}}],"directives":[]}}]},"computed":false,"property":{"type":"Identifier","name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"err"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-error"},{"type":"Identifier","name":"file"},{"type":"Identifier","name":"err"}]}},{"type":"ThrowStatement","argument":{"type":"Identifier","name":"err"}}],"directives":[]}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"onReceiveUploadUrl"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"uploadURL","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSUnionType","types":[{"type":"TSStringKeyword"},{"type":"TSNullKeyword"}]}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"currentFile"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"Identifier","name":"currentFile"}},"consequent":{"type":"ReturnStatement","argument":null},"alternate":null},{"type":"IfStatement","test":{"type":"LogicalExpression","left":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"currentFile"},"computed":false,"property":{"type":"Identifier","name":"tus"}}},"operator":"||","right":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"currentFile"},"computed":false,"property":{"type":"Identifier","name":"tus"}},"computed":false,"property":{"type":"Identifier","name":"uploadUrl"}},"operator":"!==","right":{"type":"Identifier","name":"uploadURL"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"[Tus] Storing upload url"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setFileState"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"currentFile"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"tus"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"currentFile"},"computed":false,"property":{"type":"Identifier","name":"tus"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadUrl"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"uploadURL"}}]}}]}]}}],"directives":[]},"alternate":null}],"directives":[]}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"getCompanionClientArgs"}},"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"opts"},"init":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}}}]}}],"kind":"const"},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"tus"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Object"},"computed":false,"property":{"type":"Identifier","name":"assign"}},"arguments":[{"type":"Identifier","name":"opts"},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"tus"}}]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"UnaryExpression","operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}}},"operator":"===","right":{"type":"StringLiteral","value":"function"}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}},"arguments":[{"type":"Identifier","name":"file"}]}}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"remote"}},"computed":false,"property":{"type":"Identifier","name":"body"},"optional":true}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"endpoint"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"endpoint"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"uploadUrl"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"uploadUrl"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"protocol"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"tus"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"size"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"size"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"headers"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"opts"},"computed":false,"property":{"type":"Identifier","name":"headers"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"metadata"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}}]}}],"directives":[]}},{"type":"ClassPrivateMethod","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadFiles"}},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"files","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesFiltered"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"filterNonFailedFiles"},"arguments":[{"type":"Identifier","name":"files"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesToEmit"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"filterFilesToEmitUploadStarted"},"arguments":[{"type":"Identifier","name":"filesFiltered"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"upload-start"},{"type":"Identifier","name":"filesToEmit"}]}},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"allSettled"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"filesFiltered"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"file"}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isRemote"}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"getQueue"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"controller"},"init":{"type":"NewExpression","callee":{"type":"Identifier","name":"AbortController"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"removedHandler"},"init":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"removedFile","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"removedFile"},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"===","right":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"controller"},"computed":false,"property":{"type":"Identifier","name":"abort"}},"arguments":[]}},"alternate":null}],"directives":[]}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"on"}},"arguments":[{"type":"StringLiteral","value":"file-removed"},{"type":"Identifier","name":"removedHandler"}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadPromise"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getRequestClientForFile"}},"arguments":[{"type":"Identifier","name":"file"}],"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"RequestClient"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}]}},"computed":false,"property":{"type":"Identifier","name":"uploadRemoteFile"}},"arguments":[{"type":"Identifier","name":"file"},{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"getCompanionClientArgs"}}},"arguments":[{"type":"Identifier","name":"file"}]},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"signal"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"controller"},"computed":false,"property":{"type":"Identifier","name":"signal"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"getQueue"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"getQueue"}}]}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"requests"}},"computed":false,"property":{"type":"Identifier","name":"wrapSyncFunction"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"off"}},"arguments":[{"type":"StringLiteral","value":"file-removed"},{"type":"Identifier","name":"removedHandler"}]}}],"directives":[]}},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"priority"},"computed":false,"shorthand":false,"value":{"type":"UnaryExpression","operator":"-","prefix":true,"argument":{"type":"NumericLiteral","value":1}}}]}]},"arguments":[]}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"uploadPromise"}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadLocalFile"}}},"arguments":[{"type":"Identifier","name":"file"}]}}],"directives":[]}}]}]}}}],"directives":[]}},{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"handleUpload"}},"value":{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"fileIDs","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileIDs"},"computed":false,"property":{"type":"Identifier","name":"length"}},"operator":"===","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"[Tus] No files to upload"}]}},{"type":"ReturnStatement","argument":null}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"limit"}},"operator":"===","right":{"type":"NumericLiteral","value":0}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0"},{"type":"StringLiteral","value":"warning"}]}}],"directives":[]},"alternate":null},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"StringLiteral","value":"[Tus] Uploading..."}]}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"filesToUpload"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFilesByIds"}},"arguments":[{"type":"Identifier","name":"fileIDs"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"uploadFiles"}}},"arguments":[{"type":"Identifier","name":"filesToUpload"}]}}}],"directives":[]}}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"install"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setState"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"capabilities"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getState"}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"capabilities"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"resumableUploads"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":true}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"addUploader"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"handleUpload"}}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"uninstall"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setState"}},"arguments":[{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"capabilities"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getState"}},"arguments":[]},"computed":false,"property":{"type":"Identifier","name":"capabilities"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"resumableUploads"},"computed":false,"shorthand":false,"value":{"type":"BooleanLiteral","value":false}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"removeUploader"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"handleUpload"}}}]}}],"directives":[]}}]}}}],"directives":[]}}}},"renamedFiles":{"mappings":[],"before":{},"after":{}}}