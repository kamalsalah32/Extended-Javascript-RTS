{"addedFiles":{},"deletedFiles":{},"modifiedFiles":{"before":{"packages/@uppy/compressor/src/index.ts":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"module","interpreter":null,"body":[{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"BasePlugin"},"importKind":"value","local":{"type":"Identifier","name":"BasePlugin"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Uppy"},"importKind":"value","local":{"type":"Identifier","name":"Uppy"}}],"source":{"type":"StringLiteral","value":"@uppy/core"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RateLimitedQueue"},"importKind":"value","local":{"type":"Identifier","name":"RateLimitedQueue"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/RateLimitedQueue"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"getFileNameAndExtension"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/getFileNameAndExtension"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"prettierBytes"}}],"source":{"type":"StringLiteral","value":"@transloadit/prettier-bytes"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"CompressorJS"}}],"source":{"type":"StringLiteral","value":"compressorjs"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"Body"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Meta"},"importKind":"value","local":{"type":"Identifier","name":"Meta"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UppyFile"},"importKind":"value","local":{"type":"Identifier","name":"UppyFile"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/UppyFile"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"PluginOpts"},"importKind":"value","local":{"type":"Identifier","name":"PluginOpts"}}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/BasePlugin.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"locale"}}],"source":{"type":"StringLiteral","value":"./locale.ts"}},{"type":"TSModuleDeclaration","id":{"type":"StringLiteral","value":"@uppy/core"},"body":{"type":"TSModuleBlock","body":[{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"UppyEventMap"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"StringLiteral","value":"compressor:complete"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}}}]}}}]},"declare":true},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"CompressorOpts"},"extends":[{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"PluginOpts"}},{"type":"TSExpressionWithTypeArguments","expression":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"CompressorJS"},"right":{"type":"Identifier","name":"Options"}}}],"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"quality"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}},{"type":"TSPropertySignature","key":{"type":"Identifier","name":"limit"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}}]}}},{"type":"ExportDefaultDeclaration","exportKind":"value","declaration":{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Compressor"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"superClass":{"type":"Identifier","name":"BasePlugin"},"superTypeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"CompressorOpts"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]},"body":{"type":"ClassBody","body":[{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"RateLimitedQueue"}},"value":null},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"constructor"},"computed":false,"kind":"constructor","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uppy","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Uppy"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"CompressorOpts"}}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Super"},"arguments":[{"type":"Identifier","name":"uppy"},{"type":"Identifier","name":"opts"}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"id"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"||","right":{"type":"StringLiteral","value":"Compressor"}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"type"}},"right":{"type":"StringLiteral","value":"modifier"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"defaultLocale"}},"right":{"type":"Identifier","name":"locale"}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"defaultOptions"},"init":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"quality"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":0.6}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":10}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"right":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"defaultOptions"}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"opts"}}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"RateLimitedQueue"}}},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"RateLimitedQueue"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"limit"}}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"i18nInit"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"prepareUpload"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"prepareUpload"}},"computed":false,"property":{"type":"Identifier","name":"bind"}},"arguments":[{"type":"ThisExpression"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"compress"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"compress"}},"computed":false,"property":{"type":"Identifier","name":"bind"}},"arguments":[{"type":"ThisExpression"}]}}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"compress"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"blob","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"File"}}]}]}}},"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"reject"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"NewExpression","callee":{"type":"Identifier","name":"CompressorJS"},"arguments":[{"type":"Identifier","name":"blob"},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"success"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"resolve"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"error"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"reject"}}]}]}}],"directives":[]}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"prepareUpload"},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"fileIDs","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"totalCompressedSize"},"init":{"type":"NumericLiteral","value":0}}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressedFiles","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}},"init":{"type":"ArrayExpression","elements":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressAndApplyResult"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"RateLimitedQueue"}}},"computed":false,"property":{"type":"Identifier","name":"wrapPromiseFunction"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","block":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressedBlob"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"compress"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressedSavingsSize"},"init":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"size"}},"operator":"-","right":{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedBlob"},"computed":false,"property":{"type":"Identifier","name":"size"}}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"CallExpression","callee":{"type":"Identifier","name":"prettierBytes"},"arguments":[{"type":"Identifier","name":"compressedSavingsSize"}]}],"quasis":[{"type":"TemplateElement","value":{"raw":"[Image Compressor] Image ","cooked":"[Image Compressor] Image "},"tail":false},{"type":"TemplateElement","value":{"raw":" compressed by ","cooked":" compressed by "},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"+=","left":{"type":"Identifier","name":"totalCompressedSize"},"right":{"type":"Identifier","name":"compressedSavingsSize"}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"name"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"name"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"type"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"size"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"size"}}]},"init":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"compressedBlob"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"File"}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressedFileName"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getFileNameAndExtension"},"arguments":[{"type":"Identifier","name":"name"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"metaFileName"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getFileNameAndExtension"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"name"}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"newMetaName"},"init":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"metaFileName"},"computed":false,"property":{"type":"Identifier","name":"name"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedFileName"},"computed":false,"property":{"type":"Identifier","name":"extension"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":".","cooked":"."},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setFileState"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"Identifier","name":"name"},"operator":"&&","right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"name"}}]}}},{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedFileName"},"computed":false,"property":{"type":"Identifier","name":"extension"}},"operator":"&&","right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"extension"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedFileName"},"computed":false,"property":{"type":"Identifier","name":"extension"}}}]}}},{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"Identifier","name":"type"},"operator":"&&","right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}}]}}},{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"Identifier","name":"size"},"operator":"&&","right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"size"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"size"}}]}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"compressedBlob"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"meta"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"newMetaName"}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedFiles"},"computed":false,"property":{"type":"Identifier","name":"push"}},"arguments":[{"type":"Identifier","name":"file"}]}}],"directives":[]},"handler":{"type":"CatchClause","param":{"type":"Identifier","name":"err"},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"[Image Compressor] Failed to compress ","cooked":"[Image Compressor] Failed to compress "},"tail":false},{"type":"TemplateElement","value":{"raw":":","cooked":":"},"tail":true}]},{"type":"StringLiteral","value":"warning"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"Identifier","name":"err"},{"type":"StringLiteral","value":"warning"}]}}],"directives":[]}},"finalizer":null}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"promises"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileIDs"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"fileID"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"file"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"Identifier","name":"fileID"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"preprocess-progress"},{"type":"Identifier","name":"file"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"mode"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"indeterminate"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"message"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"i18n"}},"arguments":[{"type":"StringLiteral","value":"compressingImages"}]}}]}]}},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isRemote"}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"resolve"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"type"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"slice"}},"arguments":[{"type":"NumericLiteral","value":0},{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"size"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"type"}}]}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"type"}},"computed":false,"property":{"type":"Identifier","name":"startsWith"},"optional":true},"optional":false,"arguments":[{"type":"StringLiteral","value":"image/"}]}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"resolve"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"compressAndApplyResult"},"arguments":[{"type":"Identifier","name":"file"}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"all"}},"arguments":[{"type":"Identifier","name":"promises"}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"compressor:complete"},{"type":"Identifier","name":"compressedFiles"}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"totalCompressedSize"},"operator":">","right":{"type":"NumericLiteral","value":1024}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"info"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"i18n"}},"arguments":[{"type":"StringLiteral","value":"compressedX"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"size"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"Identifier","name":"prettierBytes"},"arguments":[{"type":"Identifier","name":"totalCompressedSize"}]}}]}]},{"type":"StringLiteral","value":"info"}]}}],"directives":[]},"alternate":null},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileID"},"init":null}],"kind":"const"},"right":{"type":"Identifier","name":"fileIDs"},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"file"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"Identifier","name":"fileID"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"preprocess-complete"},{"type":"Identifier","name":"file"}]}}],"directives":[]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"install"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"addPreProcessor"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"prepareUpload"}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"uninstall"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"removePreProcessor"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"prepareUpload"}}]}}],"directives":[]}}]}}}],"directives":[]}}},"after":{"packages/@uppy/compressor/src/index.ts":{"type":"File","errors":[],"program":{"type":"Program","sourceType":"module","interpreter":null,"body":[{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"BasePlugin"},"importKind":"value","local":{"type":"Identifier","name":"BasePlugin"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Uppy"},"importKind":"value","local":{"type":"Identifier","name":"Uppy"}}],"source":{"type":"StringLiteral","value":"@uppy/core"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"RateLimitedQueue"},"importKind":"value","local":{"type":"Identifier","name":"RateLimitedQueue"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/RateLimitedQueue"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"getFileNameAndExtension"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/getFileNameAndExtension"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"prettierBytes"}}],"source":{"type":"StringLiteral","value":"@transloadit/prettier-bytes"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"CompressorJS"}}],"source":{"type":"StringLiteral","value":"compressorjs"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Body"},"importKind":"value","local":{"type":"Identifier","name":"Body"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"Meta"},"importKind":"value","local":{"type":"Identifier","name":"Meta"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"UppyFile"},"importKind":"value","local":{"type":"Identifier","name":"UppyFile"}}],"source":{"type":"StringLiteral","value":"@uppy/utils/lib/UppyFile"}},{"type":"ImportDeclaration","importKind":"type","specifiers":[{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"DefinePluginOpts"},"importKind":"value","local":{"type":"Identifier","name":"DefinePluginOpts"}},{"type":"ImportSpecifier","imported":{"type":"Identifier","name":"PluginOpts"},"importKind":"value","local":{"type":"Identifier","name":"PluginOpts"}}],"source":{"type":"StringLiteral","value":"@uppy/core/lib/BasePlugin.js"}},{"type":"ImportDeclaration","importKind":"value","specifiers":[{"type":"ImportDefaultSpecifier","local":{"type":"Identifier","name":"locale"}}],"source":{"type":"StringLiteral","value":"./locale.ts"}},{"type":"TSModuleDeclaration","id":{"type":"StringLiteral","value":"@uppy/core"},"body":{"type":"TSModuleBlock","body":[{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"UppyEventMap"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"StringLiteral","value":"compressor:complete"},"computed":false,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSFunctionType","parameters":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}}],"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}}}}}]}}}]},"declare":true},{"type":"ExportNamedDeclaration","exportKind":"type","specifiers":[],"source":null,"declaration":{"type":"TSInterfaceDeclaration","id":{"type":"Identifier","name":"CompressorOpts"},"extends":[{"type":"TSExpressionWithTypeArguments","expression":{"type":"Identifier","name":"PluginOpts"}},{"type":"TSExpressionWithTypeArguments","expression":{"type":"TSQualifiedName","left":{"type":"Identifier","name":"CompressorJS"},"right":{"type":"Identifier","name":"Options"}}}],"body":{"type":"TSInterfaceBody","body":[{"type":"TSPropertySignature","key":{"type":"Identifier","name":"limit"},"computed":false,"optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSNumberKeyword"}}}]}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"defaultOptions"},"init":{"type":"TSSatisfiesExpression","expression":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"quality"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":0.6}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"limit"},"computed":false,"shorthand":false,"value":{"type":"NumericLiteral","value":10}}]},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Partial"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"CompressorOpts"}}]}}}}],"kind":"const"},{"type":"ExportDefaultDeclaration","exportKind":"value","declaration":{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Compressor"},"typeParameters":{"type":"TSTypeParameterDeclaration","params":[{"type":"TSTypeParameter","name":"M","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Meta"}}},{"type":"TSTypeParameter","name":"B","constraint":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Body"}}}]},"superClass":{"type":"Identifier","name":"BasePlugin"},"superTypeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"DefinePluginOpts"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"CompressorOpts"}},{"type":"TSTypeOperator","operator":"keyof","typeAnnotation":{"type":"TSTypeQuery","exprName":{"type":"Identifier","name":"defaultOptions"}}}]}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]},"body":{"type":"ClassBody","body":[{"type":"ClassPrivateProperty","static":false,"key":{"type":"PrivateName","id":{"type":"Identifier","name":"RateLimitedQueue"}},"value":null},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"constructor"},"computed":false,"kind":"constructor","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"uppy","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Uppy"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}},{"type":"Identifier","name":"opts","optional":true,"typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"CompressorOpts"}}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"Super"},"arguments":[{"type":"Identifier","name":"uppy"},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"Identifier","name":"defaultOptions"}},{"type":"SpreadElement","argument":{"type":"Identifier","name":"opts"}}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"id"}},"right":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"id"}},"operator":"||","right":{"type":"StringLiteral","value":"Compressor"}}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"type"}},"right":{"type":"StringLiteral","value":"modifier"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"defaultLocale"}},"right":{"type":"Identifier","name":"locale"}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"RateLimitedQueue"}}},"right":{"type":"NewExpression","callee":{"type":"Identifier","name":"RateLimitedQueue"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}},"computed":false,"property":{"type":"Identifier","name":"limit"}}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"i18nInit"}},"arguments":[]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"prepareUpload"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"prepareUpload"}},"computed":false,"property":{"type":"Identifier","name":"bind"}},"arguments":[{"type":"ThisExpression"}]}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"compress"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"compress"}},"computed":false,"property":{"type":"Identifier","name":"bind"}},"arguments":[{"type":"ThisExpression"}]}}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"compress"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"blob","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSUnionType","types":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Blob"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"File"}}]}]}}},"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"NewExpression","callee":{"type":"Identifier","name":"Promise"},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"resolve"},{"type":"Identifier","name":"reject"}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"NewExpression","callee":{"type":"Identifier","name":"CompressorJS"},"arguments":[{"type":"Identifier","name":"blob"},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"opts"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"success"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"resolve"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"error"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"reject"}}]}]}}],"directives":[]}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"prepareUpload"},"computed":false,"kind":"method","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"fileIDs","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSStringKeyword"}}}}],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"Promise"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSVoidKeyword"}]}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"totalCompressedSize"},"init":{"type":"NumericLiteral","value":0}}],"kind":"let"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressedFiles","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSArrayType","elementType":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}},"init":{"type":"ArrayExpression","elements":[]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressAndApplyResult"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"PrivateName","id":{"type":"Identifier","name":"RateLimitedQueue"}}},"computed":false,"property":{"type":"Identifier","name":"wrapPromiseFunction"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":true,"params":[{"type":"Identifier","name":"file","typeAnnotation":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"UppyFile"},"typeParameters":{"type":"TSTypeParameterInstantiation","params":[{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"M"}},{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"B"}}]}}}}],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","block":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressedBlob"},"init":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"compress"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}}]}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressedSavingsSize"},"init":{"type":"BinaryExpression","left":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"size"}},"operator":"-","right":{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedBlob"},"computed":false,"property":{"type":"Identifier","name":"size"}}}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"CallExpression","callee":{"type":"Identifier","name":"prettierBytes"},"arguments":[{"type":"Identifier","name":"compressedSavingsSize"}]}],"quasis":[{"type":"TemplateElement","value":{"raw":"[Image Compressor] Image ","cooked":"[Image Compressor] Image "},"tail":false},{"type":"TemplateElement","value":{"raw":" compressed by ","cooked":" compressed by "},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"+=","left":{"type":"Identifier","name":"totalCompressedSize"},"right":{"type":"Identifier","name":"compressedSavingsSize"}}},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"ObjectPattern","properties":[{"type":"ObjectProperty","key":{"type":"Identifier","name":"name"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"name"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"type"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}},{"type":"ObjectProperty","key":{"type":"Identifier","name":"size"},"computed":false,"method":false,"shorthand":true,"value":{"type":"Identifier","name":"size"}}]},"init":{"type":"TSAsExpression","expression":{"type":"Identifier","name":"compressedBlob"},"typeAnnotation":{"type":"TSTypeReference","typeName":{"type":"Identifier","name":"File"}}}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"compressedFileName"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getFileNameAndExtension"},"arguments":[{"type":"Identifier","name":"name"}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"metaFileName"},"init":{"type":"CallExpression","callee":{"type":"Identifier","name":"getFileNameAndExtension"},"arguments":[{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}},"computed":false,"property":{"type":"Identifier","name":"name"}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"newMetaName"},"init":{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"metaFileName"},"computed":false,"property":{"type":"Identifier","name":"name"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedFileName"},"computed":false,"property":{"type":"Identifier","name":"extension"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","value":{"raw":".","cooked":"."},"tail":false},{"type":"TemplateElement","value":{"raw":"","cooked":""},"tail":true}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"setFileState"}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}},{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"Identifier","name":"name"},"operator":"&&","right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"name"}}]}}},{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedFileName"},"computed":false,"property":{"type":"Identifier","name":"extension"}},"operator":"&&","right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"extension"},"computed":false,"shorthand":false,"value":{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedFileName"},"computed":false,"property":{"type":"Identifier","name":"extension"}}}]}}},{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"Identifier","name":"type"},"operator":"&&","right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}}]}}},{"type":"SpreadElement","argument":{"type":"LogicalExpression","left":{"type":"Identifier","name":"size"},"operator":"&&","right":{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"size"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"size"}}]}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"data"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"compressedBlob"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"meta"},"computed":false,"shorthand":false,"value":{"type":"ObjectExpression","properties":[{"type":"SpreadElement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"meta"}}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"type"},"computed":false,"shorthand":true,"value":{"type":"Identifier","name":"type"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"name"},"computed":false,"shorthand":false,"value":{"type":"Identifier","name":"newMetaName"}}]}}]}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"compressedFiles"},"computed":false,"property":{"type":"Identifier","name":"push"}},"arguments":[{"type":"Identifier","name":"file"}]}}],"directives":[]},"handler":{"type":"CatchClause","param":{"type":"Identifier","name":"err"},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"TemplateLiteral","expressions":[{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"id"}}],"quasis":[{"type":"TemplateElement","value":{"raw":"[Image Compressor] Failed to compress ","cooked":"[Image Compressor] Failed to compress "},"tail":false},{"type":"TemplateElement","value":{"raw":":","cooked":":"},"tail":true}]},{"type":"StringLiteral","value":"warning"}]}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"log"}},"arguments":[{"type":"Identifier","name":"err"},{"type":"StringLiteral","value":"warning"}]}}],"directives":[]}},"finalizer":null}],"directives":[]}}]}}],"kind":"const"},{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"promises"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileIDs"},"computed":false,"property":{"type":"Identifier","name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","id":null,"generator":false,"async":false,"params":[{"type":"Identifier","name":"fileID"}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"file"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"Identifier","name":"fileID"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"preprocess-progress"},{"type":"Identifier","name":"file"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"mode"},"computed":false,"shorthand":false,"value":{"type":"StringLiteral","value":"indeterminate"}},{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"message"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"i18n"}},"arguments":[{"type":"StringLiteral","value":"compressingImages"}]}}]}]}},{"type":"IfStatement","test":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"isRemote"}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"resolve"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"type"}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","operator":"=","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"right":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"slice"}},"arguments":[{"type":"NumericLiteral","value":0},{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"data"}},"computed":false,"property":{"type":"Identifier","name":"size"}},{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"type"}}]}}}],"directives":[]},"alternate":null},{"type":"IfStatement","test":{"type":"UnaryExpression","operator":"!","prefix":true,"argument":{"type":"OptionalCallExpression","callee":{"type":"OptionalMemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"file"},"computed":false,"property":{"type":"Identifier","name":"type"}},"computed":false,"property":{"type":"Identifier","name":"startsWith"},"optional":true},"optional":false,"arguments":[{"type":"StringLiteral","value":"image/"}]}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"resolve"}},"arguments":[]}}],"directives":[]},"alternate":null},{"type":"ReturnStatement","argument":{"type":"CallExpression","callee":{"type":"Identifier","name":"compressAndApplyResult"},"arguments":[{"type":"Identifier","name":"file"}]}}],"directives":[]}}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"AwaitExpression","argument":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Promise"},"computed":false,"property":{"type":"Identifier","name":"all"}},"arguments":[{"type":"Identifier","name":"promises"}]}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"compressor:complete"},{"type":"Identifier","name":"compressedFiles"}]}},{"type":"IfStatement","test":{"type":"BinaryExpression","left":{"type":"Identifier","name":"totalCompressedSize"},"operator":">","right":{"type":"NumericLiteral","value":1024}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"info"}},"arguments":[{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"i18n"}},"arguments":[{"type":"StringLiteral","value":"compressedX"},{"type":"ObjectExpression","properties":[{"type":"ObjectProperty","method":false,"key":{"type":"Identifier","name":"size"},"computed":false,"shorthand":false,"value":{"type":"CallExpression","callee":{"type":"Identifier","name":"prettierBytes"},"arguments":[{"type":"Identifier","name":"totalCompressedSize"}]}}]}]},{"type":"StringLiteral","value":"info"}]}}],"directives":[]},"alternate":null},{"type":"ForOfStatement","await":false,"left":{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileID"},"init":null}],"kind":"const"},"right":{"type":"Identifier","name":"fileIDs"},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclaration","declarations":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"file"},"init":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"getFile"}},"arguments":[{"type":"Identifier","name":"fileID"}]}}],"kind":"const"},{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"emit"}},"arguments":[{"type":"StringLiteral","value":"preprocess-complete"},{"type":"Identifier","name":"file"}]}}],"directives":[]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"install"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"addPreProcessor"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"prepareUpload"}}]}}],"directives":[]}},{"type":"ClassMethod","static":false,"key":{"type":"Identifier","name":"uninstall"},"computed":false,"kind":"method","id":null,"generator":false,"async":false,"params":[],"returnType":{"type":"TSTypeAnnotation","typeAnnotation":{"type":"TSVoidKeyword"}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"uppy"}},"computed":false,"property":{"type":"Identifier","name":"removePreProcessor"}},"arguments":[{"type":"MemberExpression","object":{"type":"ThisExpression"},"computed":false,"property":{"type":"Identifier","name":"prepareUpload"}}]}}],"directives":[]}}]}}}],"directives":[]}}}},"renamedFiles":{"mappings":[],"before":{},"after":{}}}